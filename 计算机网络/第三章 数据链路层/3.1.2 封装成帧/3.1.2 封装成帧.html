<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>3.1.2 封装成帧 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div data-symbol="⭐" class="icon"></div></div><div data-title="3.1.2 封装成帧" class="main-title"></div></div></header><article><h2 id="eg8kFe3K9nWx5iE24WZeb1" class="wolai-block"><span class="inline-wrap">帧(Frame)</span></h2><div id="7p64Jg5FpskKr9Qsqkk3iK" class="wolai-block wolai-text"><div><span class="inline-wrap">•为了实现诸如差错控制、物理寻址和流量控制等功能，</span><span class="bg-fluorescent_yellow inline-wrap"><b>数据链路层首先要使自己所看到的数据是有意义的</b></span></div></div><div id="mgcF3PddQGnbiyc3UAmaDu" class="wolai-block wolai-text"><div><span class="inline-wrap">• 除了要传送的用户数据外，还要提供关于寻址、差错控制和流量控制等所必需的控制信息，而不再是物理层的原始比特流。</span></div></div><div id="wWJnvVJJmAPu1omKvCAF3N" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>为此，数据链路层采用了被称为帧(frame)的协议数据单元作为该层的数据传送逻辑单元。</b></span></div></div><aside id="3EKtR1RtiyVrqhPd43Vuf" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">数据链路层协议的核心任务就是根据所要实现的数据链路层功能来规定帧的格式，即语法和语义。</span></aside><div id="teBi9MQ2MACG8yRgqV3PQU" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image.png" style="width: 100%"/></figure></div><div id="4R2YVvSX2KpydgpQsko7KH" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧中的语法成分被称为域或字段(field)；</span></div></div><div id="nAFFgQxBSrHYTEzJX9PJgH" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧浓缩了与数据链路层功能实现相关的各种机制</span></div></div><div id="cwcwBE4wRNAy2VGeXtGCt7" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧提高了数据处理和传输的效率</span></div></div><div id="g1QHgSMJsYmnec5eSZb4ch" class="wolai-block wolai-text"><div><span class="inline-wrap">•不同的数据链路层协议的帧格式可能会存在微小的区别。</span></div></div><details id="cJFebBhgzdFUy2iYVdjcTT" class="wolai-block"><summary><div class="marker"></div><h3><span class="inline-wrap">基本格式</span></h3></summary><div id="4ke5gUCuU9unhzb527fTpE" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧开始字段和帧结束字段分别用以指示帧或数据流的开始和结束。</span></div></div><div id="49F1XZH6PooZ5vFy3swkAZ" class="wolai-block wolai-text"><div><span class="inline-wrap">•地址字段给出节点的物理地址信息。</span></div></div><div id="abVtg4TwvpEED5GBJRgFDo" class="wolai-block wolai-text"><div><span class="inline-wrap">•第三个字段则提供有关帧的长度或类型的信息，也可能是其他一些控制信息。</span></div></div><div id="v5UkV43kUetvBbzbP2RytK" class="wolai-block wolai-text"><div><span class="inline-wrap">•数据字段承载的是来自高层即网络层的数据分组(packet)。</span></div></div><div id="aEWxcuWS1gBD196wjYxncb" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧检验序列<span class="jill"></span>FCS (Frame Check Sequence)字段提供与差错检测有关的信息。</span></div></div><div id="spmAZuyuLqh1ddh55cie8a" class="wolai-block wolai-text"><div><span class="inline-wrap">•通常数据字段之前的所有字段被统称为帧头部分，而数据字段之后的所有字段被称为帧尾部分。</span></div></div></details><details id="uTZGRqgbtr2T4FfLtteWuz" class="wolai-block"><summary><div class="marker"></div><h3><span class="inline-wrap">帧的地址</span></h3></summary><div id="xyzjX13XHTcGps8QVFNUr9" class="wolai-block wolai-text"><div><span class="inline-wrap">•帧中的地址属于物理或硬件地址</span></div></div><div id="dzheWmhTjCWBiJuisbKiQZ" class="wolai-block wolai-text"><div><span class="inline-wrap">•网卡地址(局域网)</span></div></div><div id="oMGgmxYe7UAdPWg9b9UDzW" class="wolai-block wolai-text"><div><span class="inline-wrap">•链路标识(广域网)</span></div></div><div id="cvYbSd6CrKgiP67cJiGv1U" class="wolai-block wolai-text"><div><span class="inline-wrap">•用于设备或机器的物理寻址</span></div></div><div id="a8hFjVi8pCSrg1GcceqLLt" class="wolai-block wolai-text"><div><span class="inline-wrap">•能够在多个相邻结点之间确定一个接受目标</span></div></div></details><h2 id="ruAfhWDf1KhxCsGBxMynJL" class="wolai-block"><span class="inline-wrap">成帧与拆帧：数据链路层的封装与拆封</span></h2><div id="nu5D88khmvxz5hwvqqfB1G" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_1.png" style="width: 100%"/></figure></div><div id="dKTS7eT3zQ3hT7FaYoggHC" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_2.png" style="width: 100%"/></figure></div><div id="fDZGGCRAARdQXZVsL3uvNX" class="wolai-block wolai-text"><div><span class="inline-wrap">•在发送方，数据链路层从网络层获得分组（Packet)后，要加上必要的帧头与帧尾后传送给物理层，并通过物理层传送到接收方的数据链路层。</span></div><div id="p397m9LYFjnJv4aKUPm3vg" class="wolai-block wolai-text"><div><span class="inline-wrap">• </span><span class="bg-fluorescent_yellow inline-wrap"><b>这种加上帧头与帧尾的过程就称为成帧(Framing)。</b></span></div></div></div><div id="raKE1szRxSBk5rm9bPnuLS" class="wolai-block wolai-text"><div><span class="inline-wrap">•在接收方，数据链路层则必须去掉发送端数据链路层所加的帧头和帧尾部分，从中分离出网络层所需的分组.</span></div><div id="fEmA9LHVPSFzeMkFFjsGYD" class="wolai-block wolai-text"><div><span class="inline-wrap">• </span><span class="bg-fluorescent_yellow inline-wrap"><b>将帧重新拆装成分组的过程称为拆帧。</b></span></div></div></div><h2 id="fu5BqTUgm3cM1uggcQ4P44" class="wolai-block"><span class="inline-wrap">⭐</span><span class="inline-wrap">帧的定界</span></h2><blockquote id="ubwS3VBL7BFSLtzvaN7WCz" class="wolai-block"><span class="inline-wrap">封装成帧(framing) 就是在一段数据的前后分别添加首部和尾部，然后就构成了一个帧。</span><div id="nkGn28SJZRtXQ6JiwXmRX5" class="wolai-block wolai-text"><div><span class="inline-wrap">首部和尾部的一个重要作用就是进行帧定界。</span></div></div></blockquote><div id="fHzNgEknn6wU9WxJKbuy4q" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_3.png" style="width: 100%"/></figure></div><div id="u663i9PJrsUdWCxM921HxN" class="wolai-block wolai-text"><div><span class="inline-wrap">•定界：标识帧的开始与结束</span></div></div><div id="gThiyNGy2Ym2bJm6Z66ug" class="bg-fluorescent_yellow wolai-block wolai-text wolai-center"><div><span class="inline-wrap"><b>常用方法</b></span></div></div><h3 id="eZPvMoECJLFE8RM2iyGNoM" class="wolai-block"><span class="inline-wrap">字符计数法</span></h3><blockquote id="onQVPECNK7wxWeVBhFNs8U" class="wolai-block"><span class="inline-wrap">利用头部中的一个域来指定该帧中的字符数</span></blockquote><div id="9WnL3KQ5jQDAzGnh2iW826" class="wolai-block wolai-text"><div><span class="inline-wrap">•在帧头中使用一个字段来标明帧内的字符数，</span><span class="inline-wrap"><b>通常该字段称为帧长字段。</b></span></div></div><div id="xbpT1v6QpgaBjDQU7Tz7sb" class="wolai-block wolai-text"><div><span class="inline-wrap">•如果发生传输错误，则可能更改帧长的值，从而导致帧的同步出现问题。</span></div></div><div id="s7GaqTpTXxZUw2MjshgNCp" class="wolai-block wolai-text"><div><span class="inline-wrap">•该方法通常与下面介绍的其他方法结合使用。</span></div></div><div id="iQStTD63stmD3dbQz5FRw" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_4.png" alt="如图所示，其中四帧的大小分别为5.5.8.8" style="width: 100%"/><figcaption>如图所示，其中四帧的大小分别为5.5.8.8</figcaption></figure></div><h4 id="vpFKrFPbTpfsShdfzErFQ5" class="wolai-block"><span class="inline-wrap">字符计数法的缺陷：</span></h4><div id="xhKTdBPmh8sB54yKAmQ3ju" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_5.png" style="width: 100%"/></figure></div><div id="8MwgnueL7r74x5UX7BogL3" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_6.png" style="width: 100%"/></figure></div><h3 id="cxXsCJyX5CZbhjcvju54kE" class="wolai-block"><span class="inline-wrap">带字节填充的标志字节法</span></h3><aside id="aaQzDZ3BpCCsLm59eP2pmt" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">第二种成帧方法考虑到了</span><span class="inline-wrap"><b>错误之后重新同步的问题</b></span><div id="igCWyg4mUPqp8tNBzoRHEa" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>他的做法是让每一帧都用一些特殊字节作为开始和结束</b></span></div></div><div id="ojRd2ZSzq1nLad3YSAyS1t" class="wolai-block wolai-text"><div><span class="inline-wrap">如果接收方丢失了同步，它只需要搜索标志字节就可以找到当前帧的位置</span></div></div></aside><h4 id="t53f2LMaprY5ntyAqN2bzk" class="wolai-block"><span class="inline-wrap"><b>首尾界符法：</b></span></h4><div id="5qDURehLpr4AGo1D1NcL7L" class="wolai-block wolai-text"><div><span class="inline-wrap">•每一帧以<span class="jill"></span>ASCII<span class="jill"></span>字符序列特殊的标志字节<span class="jill"></span>FLAG 加<span class="jill"></span>Header<span class="jill"></span>开始，以<span class="jill"></span>FLAGE<span class="jill"></span>加<span class="jill"></span>Trailer<span class="jill"></span>结束。</span></div></div><div id="emPk3Vn3DUY6oEZ24P2M8F" class="wolai-block wolai-text"><div><span class="inline-wrap">•DLE<span class="jill"></span>为“DataLink Escape”转义字符串的缩写，</span></div></div><div id="9FF6qgvUQgweqFcvYM4hcz" class="wolai-block wolai-text"><div><span class="bg-fluorescent_yellow inline-wrap"><b>•其缺点是成帧完全依赖于<span class="jill"></span>FLAG<span class="jill"></span>字符，而且若数据部分也出现了<span class="jill"></span>FLAG，则接收端就会错误判断帧边界。</b></span></div></div><div id="8buQ2AucQttD5G1UKPJecQ" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_7.png" style="width: 100%"/></figure></div><h4 id="nL2tPtmuggxxa26JhVFA6g" class="wolai-block"><span class="inline-wrap"><b>字符填充法</b></span></h4><aside id="2tCRBBwwTCEjeHy7kgVK8y" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">为了解决</span><span class="inline-wrap"><code>首尾界符法</code></span><span class="inline-wrap">的缺陷，我们用字符填充法来解决问题</span></aside><div id="qd16MJUBxyVdYG7XfY5v5x" class="wolai-block wolai-text"><div><span class="inline-wrap">•字符填充法可用于解决上述问题。</span><span class="inline-wrap"><b>即发送端在数据中所遇到的<span class="jill"></span>FLAG<span class="jill"></span>前再插入一个附加的<span class="jill"></span>ESC，因此只要看<span class="jill"></span>FLAG<span class="jill"></span>前有没有<span class="jill"></span>ESC，就可以把它作为数据帧分界符的标志字节，与数据中出现的标志字节区分开来。</b></span></div></div><div id="kSSHekdLChhHE7N3cW3Jzf" class="wolai-block wolai-text"><div><span class="inline-wrap">•遇到的<span class="jill"></span>ESC<span class="jill"></span>前也会加一个<span class="jill"></span>ESC，而接收端则忽略两个连续<span class="jill"></span>ESC<span class="jill"></span>的前一个。</span></div></div><div id="2u1LTeRMkLVvqCwsCsZHWQ" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_8.png" style="width: 100%"/></figure></div><div id="spwQcSZGQx3SRcCEj1Raor" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/1eb71b8a1c51a702f17436999c9c7b5c.png" style="width: 100%"/></figure></div><h4 id="wPjKxh2DHrhyQg71o5kzva" class="wolai-block"><span class="inline-wrap">字符填充法的缺点</span></h4><div id="7jCukWc4DjBFJj3xkfXhTh" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_9.png" style="width: 100%"/></figure></div><h3 id="6HRB5h5Fx4HmAyktsfGG8r" class="wolai-block"><span class="inline-wrap">带位填充的标志比特法</span></h3><aside id="6dwSVgYyCLZBiuxvYsZxHJ" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">为了解决</span><span class="inline-wrap"><code>字符填充法</code></span><span class="inline-wrap">的缺点，我们使用</span><span class="inline-wrap"><code>位填充</code></span><span class="inline-wrap">机制来解决</span></aside><ul class="wolai-block"><li id="8D8RutdZJ2GrWpDzS5tQHK"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>发送端在数据中若遇到<span class="jill"></span>5<span class="jill"></span>个连续的“1”时，则在其后自动插队入一个“0”。该技术简称“逢五<span class="jill"></span>1<span class="jill"></span>插<span class="jill"></span>0”；</b></span></li><li id="m1C5x1gs49ZDUoiEcFXqUu"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>接收端则忽略<span class="jill"></span>5<span class="jill"></span>个连续的“1”后面的“0”，简称“逢五<span class="jill"></span>1<span class="jill"></span>删<span class="jill"></span>0”。</b></span></li></ul><div id="biNgMi4juSNGvYrT2Mhd8P" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_10.png" style="width: 100%"/></figure></div><aside id="2YKrehAT4TyuTrtVqkeCrq" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">特点：首尾都有<span class="jill"></span>6<span class="jill"></span>个<span class="jill"></span>1</span></aside><div id="9w1ZecVnPDJu2ig3YEHLKm" class="wolai-block wolai-text"><div><span class="inline-wrap">这个方法事实上解决了</span><span class="inline-wrap"><a href="../%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93/%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93.html#nHeDjJhy3MDZmus9JyfkxY" class="wolai-bi-link"><span class="embed-page">透明传输</span></a></span><span class="inline-wrap">的问题</span></div></div><div class="block-ref"><div class="decorator"></div><div id="d3H7GnRJu8ivcaKVjhgLFQ" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_11.png" style="width: 100%"/></figure></div></div><h3 id="u4xaxy6TM3EZLCkLVsPGdv" class="wolai-block"><span class="inline-wrap">物理层编码违例法</span></h3><div id="u3VT6oxfs142aoQY42fRoN" class="wolai-block wolai-text"><div><span class="inline-wrap">•利用物理层信息编码中未用的电信号来作为帧的边界。</span></div></div><div id="4rKkx5ckPsLfvJTteVVTYH" class="wolai-block wolai-text"><div><span class="inline-wrap">•采用冗余编码技术，如</span><span class="inline-wrap"><b>曼切斯特编码</b></span><span class="inline-wrap">，即对连续两个信号进行采样，可得到一个二进制位</span></div></div><div id="nDHyYKkTLe6XVktwLf3rFx" class="wolai-block wolai-text"><div><span class="inline-wrap">•数据<span class="jill"></span>0：低-高电平对</span></div></div><div id="qo4ZPVH9KD578v4kK6Jzcf" class="wolai-block wolai-text"><div><span class="inline-wrap">•数据<span class="jill"></span>1：高-低电平对</span></div></div><div id="sahCNXZC22f1qJjkaPrwGU" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_12.png" style="width: 41px"/></figure></div><div id="sQ4H6hAxvH1SzbVStjwudC" class="wolai-block wolai-text"><div></div></div><div id="gmoD9XhZVqJC4Bac14frGQ" class="wolai-block wolai-text"><div><span class="inline-wrap">•高-高电平对和低-低电平对没有使用，如在二进制编码中出现则称为编码违例，但这两种违例编码正好可用作帧界符，在令牌环网中使用编码违例格式。</span></div></div><div id="59Uve2S3n6S3GoL1UMSSTY" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><hr id="4yqZ1YTJ5YBG6Sb7HEGLib" class="wolai-block"/><div id="vc1cjwHLhnfLjBvdfqo9dn" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div id="6QLwdB8egcgUXHWY8FpVNv" class="wolai-block wolai-text"><div><span class="inline-wrap">用控制字符进行帧定界的方法举例</span></div></div><div id="k23FmMF31pcVs1HPqUyULa" class="wolai-block wolai-text"><div><span class="inline-wrap">•当数据是由可打印的 ASCII<span class="jill"></span>码组成的文本文件时，帧定界可以使用特殊的帧定界符。</span></div></div><div id="dG3LX2q77AMt2mT7tWzUd5" class="wolai-block wolai-text"><div><span class="inline-wrap">•控制字符 SOH(Start Of Header) 放在一帧的最前面，表示帧的首部开始。另一个控制字符<span class="jill"></span>EOT (End Of Transmission) 表示帧的结束。</span></div></div><div id="2a96RJur8ZgKNKbRh3Dxyw" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_13.png" style="width: 100%"/></figure></div></article><footer></footer></body></html>