<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>ARP - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="ARP" class="main-title"></div></div></header><article><aside id="fFtA92hJ8inLKY7SUUHVD6" class="green wolai-block"><div data-symbol="🌲" class="icon"></div><span class="inline-wrap">P359</span></aside><div id="j7DGRtsBgEiCQJ2JyVVd1S" class="wolai-block wolai-text"><div><span class="inline-wrap">假设在以太网上运行的<span class="jill"></span>IP<span class="jill"></span>协议，把需要发送的数据封装后，要交给数据链路层发送。</span></div></div><div id="9AhuG9Gpf7HNHjY3Ky6cG1" class="wolai-block wolai-text"><div><span class="inline-wrap">以太网上使用<span class="jill"></span>6<span class="jill"></span>字节的<span class="jill"></span>MAC<span class="jill"></span>地址，每一个网卡上使用的<span class="jill"></span>MAC<span class="jill"></span>地址是由网卡的生产厂家设置的，和该接口上的<span class="jill"></span>IP<span class="jill"></span>地址没有对应的关系。</span></div></div><div id="ca4Bpr67zuw7dmLysopEZD" class="wolai-block wolai-text"><div><span class="inline-wrap">IP<span class="jill"></span>层协议只知道要发送的下一站的主机和路由器的<span class="jill"></span>IP<span class="jill"></span>地址，那么链路层如何决定下一站主机的<span class="jill"></span>MAC<span class="jill"></span>地址呢?</span></div></div><div id="dR7YuhRTYwsXuJjWgSJfuD" class="wolai-block wolai-text"><div><span class="inline-wrap">在以太网等局域网上，</span><span class="green inline-wrap"><b>使用<span class="jill"></span>ARP<span class="jill"></span>协议，来实现<span class="jill"></span>IP<span class="jill"></span>地址到<span class="jill"></span>MAC<span class="jill"></span>地址的动态转换</b></span><span class="inline-wrap">。广播询问应答</span></div></div><div id="wSBFRBSK7fKMMqRjYaTs5V" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image.png" style="width: 100%"/></figure></div><aside id="wUKVDGA1BgugVrJRd9uU45" class="green wolai-block"><div data-symbol="🌲" class="icon"></div><span class="inline-wrap">在一个主机数量较少的子网，不一定非要用<span class="jill"></span>ARP<span class="jill"></span>进行地址解析，用一个配置文件也许更合适；</span><div id="sPwYRugK7GSDtVN97Rahey" class="wolai-block wolai-text"><div><span class="inline-wrap">在主机数量很多的网段使用<span class="jill"></span>ARP<span class="jill"></span>可以克服地址映射关系配置文件更新不及时的问题；</span></div></div></aside><h2 id="jA325tDRJwjArf44pA3jqZ" class="wolai-block"><span class="inline-wrap">基础概念</span></h2><div id="oqDsVqaRQkFpXxDEBaPMvD" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E7%9F%A5%E4%B9%8E/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E7%9F%A5%E4%B9%8E.html"><span>图解ARP协议（一） - 知乎</span></a></div><h2 id="4w3ZC9evVb1qjpgh8qroS1" class="wolai-block"><span class="inline-wrap">永不上的进阶文章</span></h2><div id="xfcoAenh96LUdHB3vq5RDg" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%BA%8C%EF%BC%89arp%E6%94%BB%E5%87%BB%E7%AF%87%20-%20%E7%9F%A5/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%BA%8C%EF%BC%89arp%E6%94%BB%E5%87%BB%E7%AF%87%20-%20%E7%9F%A5.html"><span>图解ARP协议（二）ARP攻击篇 - 知乎</span></a></div><div id="krhQ9EPTDDAMxL9XepuiNq" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%89%EF%BC%89arp%E9%98%B2%E5%BE%A1%E7%AF%87-%E5%A6%82%E4%BD%95%E6%8F%AA/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%89%EF%BC%89arp%E9%98%B2%E5%BE%A1%E7%AF%87-%E5%A6%82%E4%BD%95%E6%8F%AA.html"><span>图解ARP协议（三）ARP防御篇-如何揪出"内鬼"并"优雅的还手"？ - 知乎</span></a></div><div id="eV3QcuEfuyUWMUntcBfB4o" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA.html"><span>图解ARP协议（四）代理ARP：善意的欺骗 - 知乎</span></a></div><div id="cNLM4icJFzyyq54kUFv32y" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%BA%94%EF%BC%89%E5%85%8D%E8%B4%B9arp%EF%BC%9A%E5%9C%B0%E5%9D%80%E5%86%B2%E7%AA%81/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%BA%94%EF%BC%89%E5%85%8D%E8%B4%B9arp%EF%BC%9A%E5%9C%B0%E5%9D%80%E5%86%B2%E7%AA%81.html"><span>图解ARP协议（五）免费ARP：地址冲突了肿么办？ - 知乎</span></a></div><div id="r1GuDUrKMU4MqXws7g7oz" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%85%AD%EF%BC%89rarp%E4%B8%8Eiarp%EF%BC%9A/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%85%AD%EF%BC%89rarp%E4%B8%8Eiarp%EF%BC%9A.html"><span>图解ARP协议（六）RARP与IARP：被遗忘的兄弟协议 - 知乎</span></a></div><h2 id="4aGAHLSmy7wkTNFkQAKZVe" class="wolai-block"><span class="inline-wrap">跨网段传输</span></h2><div id="nu9ZiACq7PERpSFD4szP6t" class="wolai-block wolai-text"><div><span class="inline-wrap">ARP</span><span class="green inline-wrap"><b>用于解决同一个局域网上</b></span><span class="inline-wrap">的主机或路由器的<span class="jill"></span>IP 地址和硬件地址的映射问题。</span></div></div><div id="s8PJoU99a76hxa5phExJmh" class="wolai-block wolai-text"><div><span class="inline-wrap">•方案<span class="jill"></span>1: 设置<span class="jill"></span>ARP<span class="jill"></span>代理,让路由器充当其他网络的<span class="jill"></span>ARP<span class="jill"></span>代理</span></div><div id="4shY6BafRmUrL1P2KHJJgs" class="wolai-block wolai-text"><div><span class="inline-wrap">如果所要找的主机和源主机不在同一个局域网上，那么就要通过<span class="jill"></span>ARP 找到一个位于本局域网上的某个路由器的硬件地址，然后把分组发送给这个路由器，让这个路由器把分组转发给下一个网络。剩下的工作就由下一个网络来做。</span></div></div><div class="block-ref"><div class="decorator"></div><div id="eV3QcuEfuyUWMUntcBfB4o" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA.html"><span>图解ARP协议（四）代理ARP：善意的欺骗 - 知乎</span></a></div></div></div><div id="kPVVa2EJwBXwNk1dhnbVCi" class="wolai-block wolai-text"><div><span class="inline-wrap">•方案<span class="jill"></span>2:发送主机知道是发往外网段的包,直接发送给默认的以太网地址.</span></div></div><h2 id="9iybPQVud3PnHLyJEmU9T8" class="wolai-block"><span class="inline-wrap">数据包格式</span></h2><div id="eHG8EUw1LhvdAFFbKorr9L" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_1.png" style="width: 100%"/></figure></div><div id="imXybA1KhHnGNHz6JGuoYB" class="wolai-row"><div id="ArEKUACsWFBqZ7j7jgt9u" class="wolai-col" style="flex-grow: 0.5"><div id="5mt9VXoqWzKoHDQnVanKdQ" class="wolai-block wolai-text"><div><span class="inline-wrap">•硬件类型：表示其他物理网络的类型是以太网还是<span class="jill"></span>FDDI<span class="jill"></span>网等；</span></div></div><div id="f1VFaf5jWGPDdsRago7Sz8" class="wolai-block wolai-text"><div><span class="inline-wrap">•协议类型：表示网络协议类型；</span></div></div><div id="gxgtw8seQ6UtYJzNaYHAoi" class="wolai-block wolai-text"><div><span class="inline-wrap">•头长度：表示<span class="jill"></span>ARP<span class="jill"></span>报文的总长度；</span></div></div><div id="7oQdW4SxHyQD8uJv96d73T" class="wolai-block wolai-text"><div><span class="inline-wrap">•协议地址长度：对于<span class="jill"></span>IP<span class="jill"></span>协议来说，该域的值应该为<span class="jill"></span>4；</span></div></div><div id="4g3wSVHZvTJHFdCJtQ2gVr" class="wolai-block wolai-text"><div><span class="inline-wrap">•操作：表示<span class="jill"></span>ARP<span class="jill"></span>请求与响应；</span></div></div><div id="vsCx5EUSisWn2gbPrFckZk" class="wolai-block wolai-text"><div><span class="inline-wrap">•源端物理地址：源端的物理地址，由请求者填充；</span></div></div><div id="2C57fZYkutkcB6R5RFHntD" class="wolai-block wolai-text"><div><span class="inline-wrap">•源端协议地址：源端的<span class="jill"></span>IP<span class="jill"></span>地址，由请求者填充；</span></div></div><div id="w8VeYk9FcVsW5W5DJbLCuo" class="wolai-block wolai-text"><div><span class="inline-wrap">•目的端物理地址：目的端的物理地址，在请求包中应该为<span class="jill"></span>0，在响应包中则被设置为目的端的物理地址，由发送响应包的主机填充；</span></div></div><div id="v1pZXXPocR3PhbuZggLvV8" class="wolai-block wolai-text"><div><span class="inline-wrap">•目的端协议地址：由<span class="jill"></span>ARP<span class="jill"></span>请求者填充，其中含有所希望知道的主机的<span class="jill"></span>IP<span class="jill"></span>地址。仅有和该地址匹配的主机才发送响应。</span></div></div></div><div id="dWsUdNVXtdKEiT6mW6XiVt" class="wolai-col" style="flex-grow: 0.5"><div class="block-ref"><div class="decorator"></div><div id="pZqhH1mYMU8LBQezrdKgFL" class="wolai-block wolai-text"><div><span class="inline-wrap">Hardware type ：硬件类型，标识链路层协议</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="ewnRtXP2kBeHfGiAXmzigi" class="wolai-block wolai-text"><div><span class="inline-wrap">Protocol type： 协议类型，标识网络层协议</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="trb69oRkoJi7EoXonWS7Wn" class="wolai-block wolai-text"><div><span class="inline-wrap">Hardware size ：硬件地址大小，标识<span class="jill"></span>MAC<span class="jill"></span>地址长度，这里是<span class="jill"></span>6<span class="jill"></span>个字节（48bti）</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="nhwvnm8E8MXoonjULsYyVU" class="wolai-block wolai-text"><div><span class="inline-wrap">Protocol size： 协议地址大小，标识<span class="jill"></span>IP<span class="jill"></span>地址长度，这里是<span class="jill"></span>4<span class="jill"></span>个字节（32bit）</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="7bjyqqfhyds828frjW9n1M" class="wolai-block wolai-text"><div><span class="inline-wrap">Opcode： 操作代码，标识<span class="jill"></span>ARP<span class="jill"></span>数据包类型，1<span class="jill"></span>表示请求，2<span class="jill"></span>表示回应</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="bQ242ai664Yv17ip5xFfpx" class="wolai-block wolai-text"><div><span class="inline-wrap">Sender MAC address ：发送者<span class="jill"></span>MAC</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="dBogTfSQPManUDbgy951Db" class="wolai-block wolai-text"><div><span class="inline-wrap">Sender IP address ：发送者<span class="jill"></span>IP</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="7sdF5KHYy3J3kG83K69SHJ" class="wolai-block wolai-text"><div><span class="inline-wrap">Target MAC address ：目标<span class="jill"></span>MAC，此处全<span class="jill"></span>0<span class="jill"></span>表示在请求</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="pGghvBNAMnWWyYv9CRrisJ" class="wolai-block wolai-text"><div><span class="inline-wrap">Target IP address： 目标<span class="jill"></span>IP</span></div></div></div></div></div><hr id="mjcWrqsbBJWPscQDpiDBvF" class="wolai-block"/><div id="ckPRESNh8EEFA7K2zHo6KH" class="wolai-block wolai-text"><div><span class="inline-wrap">ARP<span class="jill"></span>请求分组：包含发送方硬件地址/发送方<span class="jill"></span>IP<span class="jill"></span>地址/目标方硬件地址(未知时填<span class="jill"></span>0)/ 目标方<span class="jill"></span>IP<span class="jill"></span>地址。</span></div></div><div id="rzMMstzEYhrJKRMXduyAiA" class="wolai-block wolai-text"><div><span class="inline-wrap">本地广播<span class="jill"></span>ARP 请求（路由器不转发<span class="jill"></span>ARP<span class="jill"></span>请求）。</span></div></div><div id="caca6fWxVpxS7vVhzHrEC4" class="wolai-block wolai-text"><div><span class="inline-wrap">ARP<span class="jill"></span>响应分组：包含发送方硬件地址/发送方<span class="jill"></span>IP<span class="jill"></span>地址 / 目标方硬件地址/目标方<span class="jill"></span>IP<span class="jill"></span>地址。</span></div></div><div id="onTuwWgqDhxSGSKtVXQDdy" class="wolai-block wolai-text"><div><span class="inline-wrap">ARP<span class="jill"></span>分组封装在物理网络的帧中传输。</span></div></div><hr id="nRvQrMUDwSCxwFR6Dx7z1t" class="wolai-block"/><div class="block-ref"><div class="decorator"></div><div id="vPJjyuQySr3guTnF11XgaW" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>【ARP<span class="jill"></span>请求包】</b></span><span class="inline-wrap"> </span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="kZTcta4NV9SeqUWVLWaWCZ" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="https://pic3.zhimg.com/v2-5e6176abaacf3839113a116891df9bde_b.jpg" style="width: 576px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><div id="kcFjCMAaSPvqDMaHXs27K5" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>【ARP<span class="jill"></span>回应包】</b></span><span class="inline-wrap"> </span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="r47rGEyYcDoHzefuKUs2xB" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="https://pic4.zhimg.com/v2-2216de823ce85a2cb629d2a0c774f9c3_b.jpg" style="width: 576px"/></figure></div></div><div id="bFwmFZ2FtfkRBGuoGq46ZR" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_2.png" style="width: 100%"/></figure></div><h2 id="a3fosnL5B7Ezo9oVyF2UTM" class="wolai-block"><span class="inline-wrap">问：广播 答：单播</span></h2><div id="8VfYixdAmAGcPGtx67RqF" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_3.png" style="width: 100%"/></figure></div><h2 id="3eHCxpZz9T2qZigf3MhPfE" class="wolai-block"><span class="inline-wrap">IP 地址与硬件地址 </span></h2><h3 id="ejrGLbsXZWXRHtocMfEB2e" class="wolai-block"><span class="inline-wrap">为什么不直接使用硬件地址进行通信？ </span></h3><div id="wLTCG9CLmngJdSfSvM537c" class="wolai-block wolai-text"><div><span class="inline-wrap">由于全世界存在着各式各样的网络，它们使用不同的硬件地址。要使这些异构网络能够互相通信就必须进行非常复杂的硬件地址转换工作，因此几乎是不可能的事。</span></div></div><div id="g2agu2xa6CcvuqkpoddKG3" class="wolai-block wolai-text"><div><span class="inline-wrap">IP<span class="jill"></span>编址把这个复杂问题解决了。连接到互联网的主机只需各自拥有一个唯一的 IP 地址，它们之间的通信就像连接在同一个网络上那样简单方便，因为上述的调用<span class="jill"></span>ARP<span class="jill"></span>的复杂过程都是由计算机软件自动进行的，对用户来说是看不见这种调用过程的。</span></div></div><div id="kJUa8Wpxg34WjdfqA6YJq6" class="wolai-block wolai-text"><div><span class="inline-wrap">因此，在虚拟的<span class="jill"></span>IP 网络上用 IP 地址进行通信给广大的计算机用户带来了很大的方便。</span></div></div><div id="tkfrQ9Mx5JHXZGptDSsa1P" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_4.png" style="width: 100%"/></figure></div><h2 id="hTSVtaF5xkRfn1JgW5J3Cm" class="wolai-block"><span class="inline-wrap">ARP 高速缓存 (ARP cache)</span></h2><div id="wK8KaoMpoibPfcFDjWp4Bj" class="wolai-block wolai-text"><div><span class="inline-wrap">里面有所在的局域网上的各主机和路由器的 IP 地址到硬件地址的映射表。</span></div></div><div id="bUjzpQ7BAyPvxnLk2ojzvd" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_5.png" style="width: 100%"/></figure></div><div id="cWpxpvu24HkKNPRS2zBYeE" class="wolai-block wolai-text"><div><span class="inline-wrap">当主机 A 欲向本局域网上的某个主机<span class="jill"></span>B<span class="jill"></span>发送<span class="jill"></span>IP<span class="jill"></span>数据报时，就先在其<span class="jill"></span>ARP<span class="jill"></span>高速缓存中查看有无主机<span class="jill"></span>B<span class="jill"></span>的<span class="jill"></span>IP<span class="jill"></span>地址。</span></div><div id="mYoqfZNACTkfGcNtmZPwGV" class="wolai-block wolai-text"><div><span class="inline-wrap">1.如有，就可查出其对应的硬件地址，再将此硬件地址写入<span class="jill"></span>MAC<span class="jill"></span>帧，然后通过局域网将该<span class="jill"></span>MAC<span class="jill"></span>帧发往此硬件地址。</span></div></div><div id="mUwG1Ru8ymGu7myK7tFgpr" class="wolai-block wolai-text"><div><span class="inline-wrap">2.如没有，ARP<span class="jill"></span>进程在本局域网上广播发送一个 ARP<span class="jill"></span>请求分组。收到<span class="jill"></span>ARP 响应分组后，将得到的<span class="jill"></span>IP<span class="jill"></span>地址到硬件地址的映射写入<span class="jill"></span>ARP<span class="jill"></span>高速缓存。</span></div></div></div><h3 id="5RgewDpiB5wguW5q2UP7Ae" class="wolai-block"><span class="inline-wrap">作用</span></h3><div id="88eHhkLSUykEc3iE7CNYzE" class="wolai-block wolai-text"><div><span class="inline-wrap">存放最近获得的<span class="jill"></span>IP 地址到 MAC 地址的绑定，以减少 ARP 广播的数量。</span></div></div><aside id="a1osxuyfJyEq9QTWZ48nBj" class="green wolai-block"><div data-symbol="🌲" class="icon"></div><span class="inline-wrap">ARP<span class="jill"></span>缓存可以减少发送<span class="jill"></span>ARP<span class="jill"></span>广播包的次数；</span></aside><div id="4h3yqpbr84u3YWbiQujWZp" class="wolai-block wolai-text"><div><span class="inline-wrap">为了减少网络上的通信量，主机<span class="jill"></span>A<span class="jill"></span>在发送其<span class="jill"></span>ARP<span class="jill"></span>请求分组时，就将自己的<span class="jill"></span>IP<span class="jill"></span>地址到硬件地址的映射写入<span class="jill"></span>ARP<span class="jill"></span>请求分组。</span></div></div><div id="mLYxLVC8zGY7D3QRNP2qxF" class="wolai-block wolai-text"><div><span class="inline-wrap">当主机<span class="jill"></span>B<span class="jill"></span>收到<span class="jill"></span>A<span class="jill"></span>的<span class="jill"></span>ARP<span class="jill"></span>请求分组时，就将主机<span class="jill"></span>A<span class="jill"></span>的这一地址映射写入主机<span class="jill"></span>B<span class="jill"></span>自己的<span class="jill"></span>ARP<span class="jill"></span>高速缓存中。这对主机<span class="jill"></span>B<span class="jill"></span>以后向<span class="jill"></span>A<span class="jill"></span>发送数据报时就更方便了。</span></div></div><h2 id="kvpefVEwaqyNnvD88muAjg" class="wolai-block"><span class="inline-wrap">代理<span class="jill"></span>ARP<span class="jill"></span>技术</span></h2><div class="block-ref"><div class="decorator"></div><div id="eV3QcuEfuyUWMUntcBfB4o" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="../ipv4%E5%8D%8F%E8%AE%AE/arp/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA/%E5%9B%BE%E8%A7%A3arp%E5%8D%8F%E8%AE%AE%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BB%A3%E7%90%86arp%EF%BC%9A%E5%96%84%E6%84%8F%E7%9A%84%E6%AC%BA.html"><span>图解ARP协议（四）代理ARP：善意的欺骗 - 知乎</span></a></div></div><div id="sZmMbFVEiNkhLFZaKmzSzQ" class="wolai-block wolai-text"><div><span class="inline-wrap">通过代理<span class="jill"></span>ARP<span class="jill"></span>路由器去完成网络内一组主机的<span class="jill"></span>ARP<span class="jill"></span>服务</span></div></div><div id="mahCNq3YHfh9ny86tYY27D" class="wolai-block wolai-text"><div><span class="inline-wrap">当代理<span class="jill"></span>ARP<span class="jill"></span>收到请求时，首先判断是否属于他代理的网络</span></div></div><div id="iEcb6iEiqbL3AQQ5tCQaaK" class="wolai-block wolai-text"><div><span class="inline-wrap">如果属于，代理<span class="jill"></span>ARP<span class="jill"></span>通过发送一个<span class="jill"></span>ARP<span class="jill"></span>应答，公布其物理地址</span></div></div><div id="dNKsnYmsduhsRHJU4NK4ME" class="wolai-block wolai-text"><div><span class="inline-wrap">以后在他收到真正传送给子网内一个主机的<span class="jill"></span>IP<span class="jill"></span>数据报时，它再将分组转发到子网的目的主机</span></div></div><h2 id="brWwUFiTcxYBP5qq4CF3FM" class="wolai-block"><span class="inline-wrap">使用 ARP 的四种典型情况</span></h2><div id="poqRkD15PG2hbKMjMGaHPA" class="wolai-row"><div id="c9DE3N1NnnfvXnzwDVQiD" class="wolai-col" style="flex-grow: 0.5"><ul class="wolai-block"><li id="iehfCNRMaZF6cpqdFHFfZy"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">发送方是主机，要把<span class="jill"></span>IP<span class="jill"></span>数据报发送到本网络上的另一个主机。这时用<span class="jill"></span>ARP<span class="jill"></span>找到目的主机的硬件地址。</span></li><li id="amDxw4xvnjwSwG65pPcVJ7"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">发送方是主机，要把<span class="jill"></span>IP<span class="jill"></span>数据报发送到另一个网络上的一个主机。这时用<span class="jill"></span>ARP<span class="jill"></span>找到本网络上的一个路由器的硬件地址。剩下的工作由这个路由器来完成。</span></li><li id="uHs47PsMM1KEMSNa86RVKi"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">发送方是路由器，要把<span class="jill"></span>IP<span class="jill"></span>数据报转发到本网络上的一个主机。这时用<span class="jill"></span>ARP<span class="jill"></span>找到目的主机的硬件地址。</span></li><li id="ntisc7neVPjieeKWpAdHgL"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">发送方是路由器，要把<span class="jill"></span>IP<span class="jill"></span>数据报转发到另一个网络上的一个主机。这时用<span class="jill"></span>ARP<span class="jill"></span>找到本网络上另一个路由器的硬件地址。剩下的工作由这个路由器来完成。</span></li></ul></div><div id="wtT3cWmAjqBi28U42orTTt" class="wolai-col" style="flex-grow: 0.5"><div id="9u8rq9qNryeQ7zfaRt4xa5" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image_6.png" style="width: 633.6px"/></figure></div></div></div><div id="ojej6x8c4yEBn9RQVwnvHF" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_7.png" style="width: 100%"/></figure></div><div id="kcnGLqQNEbZZ7sH4ftwogk" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>