<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../css/wolai.css"/><title>第4章 第一个程序 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="第4章 第一个程序" class="main-title"></div></div></header><article><h1 id="abcd2YYsHX1bo2XWSDmcp1" class="wolai-block"><span class="inline-wrap">一个源程序从写出到执行的过程</span></h1><div id="2NSXfPRZDXd3PEQZprbCHK" class="wolai-block wolai-text"><div><span class="inline-wrap">在使用<span class="jill"></span>C<span class="jill"></span>语言这种高级语言进行编译的时候，《深入理解计算机系统》告诉我们需要经过四步来完成源程序到可执行的二进制文件</span></div></div><div id="xqZDVZJYCk3ZQccRidwVjz" class="wolai-block wolai-text"><div><span class="inline-wrap">而汇编语言只需要经过</span><span class="inline-wrap"><code>编译器</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>链接器</code></span><span class="inline-wrap">两步就可以了。</span></div></div><div class="block-ref"><div class="decorator"></div><div id="9VizP2UhepjsSZ7BdEUBBy" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image.png" style="width: 716.8px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><div id="o5Rg6mUU5y3BeQPidLA9oD" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_1.png" style="width: 704.8px"/></figure></div></div><div id="rwCS72djhhPtEwwvMbAjBZ" class="wolai-block wolai-text"><div><span class="inline-wrap">(1) 当源程序很大时,可以将它分为多个源程序文件来编译,每个源程序编译成为目标文件后,再用连接程序将它们连接到一起,生成一个可执行文件: </span></div></div><div id="53mS2EaFjVg1NacC5B4XJc" class="wolai-block wolai-text"><div><span class="inline-wrap">(2) .程序中调用了某个库文件中的子程序,需要将这个库文件和该程序生成的目标文件连接到一起,生成一个可执行文件: </span></div></div><div id="uDtqcNoavXckjn7Ak9osS7" class="wolai-block wolai-text"><div><span class="inline-wrap">(3) 一个源程序编译后,得到了存有机器码的目标文件,目标文件中的有些内容还不能直接用来生成可执行文件,连接程序将这些内容处理为最终的可执行信息。所以,在只有一个源程序文件,而又不需要调用某个库中的子程序的情况下,也必须用连接程序对目标文件进斤处理,生成可执行文件,</span></div></div><h2 id="5kq1PvQWKjebqdgpjTSeWt" class="wolai-block"><span class="inline-wrap">可执行目标程序（二进制）</span></h2><ul class="wolai-block"><li id="d5Bb8G5US5RXtWQ2c7Uud8"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">程序（从源程序翻译过来的而机器码）和数据（源程序中定义的数据）</span></li><li id="snTKbiv1HxfRHvv2oadPHc"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">相关的描述信息</span><ul class="wolai-block"><li id="pWSMN8MaDC2SWQK2fzzTet"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">程序有多大</span></li><li id="6nBL36cLPumyc9dHZavcVR"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">要占用多少内存空间</span></li></ul></li></ul><h1 id="xkBaN8RSSN9JXNG1uLt9HD" class="wolai-block"><span class="inline-wrap">汇编程序</span></h1><div id="bNjSXsTsdCa5DnRrtwCpt9" class="wolai-block wolai-text"><div><span class="inline-wrap">汇编程序由两种指令组成：</span></div></div><h2 id="5hXnN534g8KinkzW2K8H3v" class="wolai-block"><span class="inline-wrap">伪指令</span><ul class="wolai-block"><li id="gxRqJB4FEcBQkPPiQgwMg7"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">由</span><span class="inline-wrap"><code>编译器</code></span><span class="inline-wrap">来执行的指令</span></li></ul></h2><h3 id="jtNsc3xNdA1JNyzyAHUrz" class="wolai-block"><span class="inline-wrap">XXX segment……XXX ends</span></h3><div id="68Jne7jzVqJqnTUEvE6MXz" class="wolai-block wolai-text"><div><span class="inline-wrap">定义一个段 其中<span class="jill"></span>XXX<span class="jill"></span>是由程序员命名的</span></div></div><h3 id="iEHkjgisCo4nnjmGrp5fRf" class="wolai-block"><span class="inline-wrap">end</span></h3><div id="5CgWvpa9hDa3F83FYDeSN9" class="wolai-block wolai-text"><div><span class="inline-wrap">一个</span><span class="inline-wrap"><code>汇编程序</code></span><span class="inline-wrap">的结束标记</span></div></div><div id="6ggzpvEWigAFGF8L7Hg4ef" class="wolai-block wolai-text"><div><span class="inline-wrap">注意不是段的结束标记（ends）哦</span></div></div><h3 id="dicSi5yV4LJRD8HGvhww2Q" class="wolai-block"><span class="inline-wrap">assume</span></h3><div id="wV8kkw4PfE7i8Jw3edyToD" class="wolai-block wolai-text"><div><span class="inline-wrap">将由特定用途的段和相关的段寄存器关联起来</span></div></div><div id="4DoEa7e6QM3MUjL3BwokkC" class="wolai-block wolai-text"><div><span class="inline-wrap">和 segment……ends 定义的段</span></div></div><h2 id="gei4MCcqgXgQxm3Tw3y8qd" class="wolai-block"><span class="inline-wrap">汇编指令</span><ul class="wolai-block"><li id="sj1kFUp144cGRTiFPLfZhk"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">可以被编译成机器指令，最终为<span class="jill"></span>CPU<span class="jill"></span>所执行</span></li></ul></h2><h3 id="h9XWeisNJ7s9bG9vx4eq3x" class="wolai-block"><span class="inline-wrap">返回</span></h3><div id="vAqCzLnAp8HqEptEETvGaA" class="wolai-block wolai-text"><div><span class="inline-wrap">我们在<span class="jill"></span>shell<span class="jill"></span>中运行一个程序 最后还得回到<span class="jill"></span>shell 我们需要加上这段代码</span></div></div><code-block id="a8Ao647SZS491mFTH2q7Y4" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00H
int <span class="token number">21</span>H</pre></div></code-block><h2 id="d1LMhwXc8qkzMyo4aeRY3V" class="wolai-block"><span class="inline-wrap">一个例子</span></h2><code-block id="gNwUSVPk4bmg9z89ENzAac" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>assume cs<span class="token operator">:</span>codesg

codesg segment

  mov ax<span class="token punctuation">,</span><span class="token number">0123</span>H
  mov bx<span class="token punctuation">,</span><span class="token number">0456</span>H
  add ax<span class="token punctuation">,</span>bx
  add ax<span class="token punctuation">,</span>ax
  
  mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00H  
  int <span class="token number">21</span>H
  
odesg ends
end</pre></div></code-block><div id="25WctGMv252xB6KuwuUZ9Q" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>