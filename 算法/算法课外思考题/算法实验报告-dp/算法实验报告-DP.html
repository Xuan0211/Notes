<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>算法实验报告-DP - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="算法实验报告-DP" class="main-title"></div></div></header><article><h2 id="b617UrWb8AMutnmGLMmfRT" class="wolai-block"><span class="inline-wrap">计科<span class="jill"></span>T2101 许愿</span></h2><h2 id="ke4ae2qLuGui21xSUsq7UZ" class="wolai-block"><span class="inline-wrap">8201210729</span></h2><h1 id="7PnZJVxRSYnuEy3Tg8F8S3" class="wolai-block"><span class="inline-wrap">3.计算矩阵连乘积</span></h1><h2 id="dXQY1uRAvghvwgCpbDxKiS" class="wolai-block"><span class="inline-wrap">问题描述</span></h2><div class="block-ref"><div class="decorator"></div><div id="3rRsTvEjaorpeGMz4DbpD7" class="wolai-block wolai-text"><div><span class="inline-wrap">《算法竞赛入门经典》P277（电子书<span class="jill"></span>P429）</span></div></div></div><div class="block-ref"><div class="decorator"></div><blockquote id="352sLmq7HTqxAu2o49fQNg" class="bg-blond wolai-block"><span class="inline-wrap">一个<span class="jill"></span>n×m<span class="jill"></span>矩阵由<span class="jill"></span>n<span class="jill"></span>行<span class="jill"></span>m<span class="jill"></span>列共个数排列而成。两个矩阵<span class="jill"></span>A<span class="jill"></span>和<span class="jill"></span>B<span class="jill"></span>可以相乘当且仅当<span class="jill"></span>A<span class="jill"></span>的列数等于<span class="jill"></span>B<span class="jill"></span>的行数。一个<span class="jill"></span>n×m<span class="jill"></span>的矩阵乘以一个<span class="jill"></span>m×p<span class="jill"></span>的矩阵等于一个的矩阵，运算量为<span class="jill"></span>mnp。
矩阵乘法不满足分配律，但满足结合律，因此<span class="jill"></span>A×B×C<span class="jill"></span>既可以按顺序(A×B)×C<span class="jill"></span>进行，也可以按<span class="jill"></span>A×(B×C)进行。假设<span class="jill"></span>A、B、C<span class="jill"></span>分别是<span class="jill"></span>2×3，3×4<span class="jill"></span>和<span class="jill"></span>4×5<span class="jill"></span>的，则(A×B)×C<span class="jill"></span>的运算量为<span class="jill"></span>2×3×4＋2×4×5＝64，A×(B×C)的运算量为<span class="jill"></span>3×4×5＋2×3×5＝90。显然第一种顺序节省运算量。</span><div id="pE9NQwGuxppJS3ivrsBbBJ" class="wolai-block wolai-text"><div><span class="inline-wrap">
</span><span class="inline-wrap"><b>给出<span class="jill"></span>n<span class="jill"></span>个矩阵组成的序列，设计一种方法把它们依次乘起来，使得总的运算量尽量小。假设第<span class="jill"></span>i<span class="jill"></span>个矩阵<span class="jill"></span>Ai<span class="jill"></span>是</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>×</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_{i-1}×p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap"><b> 的</b></span></div></div></blockquote></div><h2 id="hCpMXQd8Y8s9AZWqRWfMzJ" class="wolai-block"><span class="inline-wrap">算法思想：DP</span></h2><div class="block-ref"><div class="decorator"></div><h4 id="3fj7U2bExZ3iMZjcEfpMX8" class="wolai-block"><span class="inline-wrap">状态定义</span></h4></div><div class="block-ref"><div class="decorator"></div><div id="ruVGAvepZ6TBgqqWp1Rzm7" class="wolai-block wolai-text"><div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">就是前面记忆化的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">m[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">，代表着对</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><mo>…</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">A_i,\dots A_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">求解矩阵乘法问题</span></div></div></div><div class="block-ref"><div class="decorator"></div><h4 id="2boFD8TcWWPZAN4MVfhMxS" class="wolai-block"><span class="inline-wrap">基情况</span></h4></div><div class="block-ref"><div class="decorator"></div><div id="ePoarCFRvJJigqR9uy4AEH" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mi>f</mi><mtext>     </mtext><mi>i</mi><mo>=</mo><mi>j</mi><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>:</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><mspace linebreak="newline"></mspace><mi>s</mi><mi>o</mi><mtext>     </mtext><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">if\ \ \ \ \ i=j, A[i: j]=A_i, \\so\ \ \ \ \ dp[i, i]=0, i=1,2, \ldots, n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">so</span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span></span></div></div><div class="block-ref"><div class="decorator"></div><h4 id="rtXQVPqKhm1KASqLLhEZW1" class="wolai-block"><span class="inline-wrap">状态转移方程</span></h4></div><div class="block-ref"><div class="decorator"></div><div id="YTRV2ybbrMsyS51Ko7Spe" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mspace linebreak="newline"></mspace><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>i</mi><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>j</mi></mrow></munder><mrow><mo fence="true">(</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>p</mi><mi>k</mi></msub><msub><mi>p</mi><mi>j</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">dp[i, i]=0\\dp[i, j]=\min _{i&lt;k&lt;j}\left(dp[i, k]+dp[k+1, j]+p_{i-1} p_{k} p_{j}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6382em;vertical-align:-0.8882em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></div></div><div class="block-ref"><div class="decorator"></div><div id="291XgH8niAR84HJYNstdts" class="wolai-block wolai-text"><div><span class="inline-wrap">其中</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">s[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">中记录着最后一次做乘法的位置</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="2jp3SaFqhJwHT2axxmp2c2" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image.png" style="width: 525.6px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><div id="7VvgdddAxsXY4ZzG2JuDUH" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image_1.png" style="width: 100%"/></figure></div></div><div class="block-ref"><div class="decorator"></div><div id="4uKMaQ1GpSk3RUZ8JHbxyS" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image_2.png" style="width: 524.8px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><div id="5d99BMz7Xzwd17LfjLrDVW" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image_3.png" style="width: 414.4px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><blockquote id="4cQmwvrqHABN7PJvRCKhm" class="bg-blond wolai-block"><span class="inline-wrap">上述方程有些特殊：记忆化搜索固然没问题，但如果要写成递推，无论按照<span class="jill"></span>i<span class="jill"></span>还是<span class="jill"></span>j<span class="jill"></span>的递增或递减顺序均不正确。</span><span class="inline-wrap"><b>正确的方法是按照<span class="jill"></span>j－i<span class="jill"></span>递增的顺序递推，因为长区间的值依赖于短区间的值</b></span></blockquote></div><h2 id="oKyLgSmzL9osHB6gBNqoPR" class="wolai-block"><span class="inline-wrap">性能分析</span></h2><div class="block-ref"><div class="decorator"></div><div id="a9AenH33FC6eUewTGZdg7F" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>n</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>j</mi><mo>−</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mstyle mathcolor="b"><mtext>首项：</mtext><mi>i</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>=</mo><mn>1</mn></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>末项：</mtext><mi>n</mi><mo>−</mo><mi>i</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>项数：</mtext><mi>n</mi><mo>−</mo><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>n</mi><mo>−</mo><mi>i</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>n</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>n</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>−</mo><mn>2</mn><mi>n</mi><mi>i</mi><mo>+</mo><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><mi>n</mi><mo>−</mo><mi>i</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>n</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>n</mi><mn>2</mn></msup><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mi>n</mi><mi>i</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>i</mi><mn>2</mn></msup><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>n</mi><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>i</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>12</mn></mfrac><mrow><mo fence="true">(</mo><mn>12</mn><mi>n</mi><mo>+</mo><mn>2</mn><msup><mi>n</mi><mn>3</mn></msup><mo>−</mo><mn>2</mn><mi>n</mi><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>12</mn></mfrac><mrow><mo fence="true">(</mo><mn>10</mn><mi>n</mi><mo>+</mo><mn>2</mn><msup><mi>n</mi><mn>3</mn></msup><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mrow><mo fence="true">(</mo><mn>5</mn><mi>n</mi><mo>+</mo><msup><mi>n</mi><mn>3</mn></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}T(n)&amp;=n+\sum_{i=1}^{n} \sum_{j=i+1}^{n}(j-i)\\\color{b}首项： i+1-i=1\\末项： n-i\\项数： n-(i+1)+1=n-i\\&amp;=n+\sum_{i=1}^{n} \frac{(n-i)(n-i+1)}{2}\\&amp;=n+\frac{1}{2} \sum_{i=1}^{n}\left(n^{2}-2 n i+i^{2}+n-i\right)\\&amp;=n+\frac{1}{2}\left(\sum_{i=1}^{n} n^{2}-\sum_{i=1}^{n} 2 n i+\sum_{i=1}^{n} i^{2}+\sum_{i=1}^{n} n-\sum_{i=1}^{n} i\right)\\&amp;=\frac{1}{12}\left(12 n+2 n^{3}-2 n\right)=\frac{1}{12}\left(10 n+2 n^{3}\right)=\frac{1}{6}\left(5 n+n^{3}\right)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:19.9584em;vertical-align:-9.7292em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10.2292em;"><span style="top:-12.3278em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top:-9.774em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord cjk_fallback" style="color:b;">首项：</span><span class="mord mathnormal" style="color:b;">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:b;">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord" style="color:b;">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:b;">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="color:b;">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:b;">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord" style="color:b;">1</span></span></span><span style="top:-8.274em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord cjk_fallback">末项：</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span></span></span><span style="top:-6.774em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord cjk_fallback">项数：</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span></span></span><span style="top:-4.4626em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:-1.2336em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:2.0941em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span><span style="top:4.9932em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.7292em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10.2292em;"><span style="top:-12.3278em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span><span style="top:-4.4626em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.2336em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">ni</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:2.0941em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord mathnormal">ni</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:4.9932em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">12</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">12</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">12</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">10</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.225em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.05em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">5</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.7292em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></div><h2 id="rm2YhaHLEuyAauKXSAVa8n" class="wolai-block"><span class="inline-wrap">优化：四边形不等式</span></h2><div class="block-ref"><div class="decorator"></div><div id="3HaBHkieTi4GjXvQdvrp4r" class="wolai-block wolai-text"><div><span class="inline-wrap">形如：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="74fbS56wBZHJ8AAoLbZ8Nj" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">[</mo><mi mathvariant="normal">i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi mathvariant="normal">j</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">[</mo><mi mathvariant="normal">i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi mathvariant="normal">k</mi><mo stretchy="false">]</mo><mo>+</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">[</mo><mi mathvariant="normal">k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi mathvariant="normal">j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mi>t</mi><mo stretchy="false">[</mo><mi mathvariant="normal">i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi mathvariant="normal">j</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">{</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\mathrm{dp}[\mathrm{i}][\mathrm{j}]&amp;=\min \{\mathrm{dp}[\mathrm{i}][\mathrm{k}]+\mathrm{dp}[\mathrm{k}+1][\mathrm{j}]+\cos t[\mathrm{i}][\mathrm{j}]\}\\&amp;=min\{dp[i][k]+dp[k+1][j]\}+cost[i][j]\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">dp</span></span><span class="mopen">[</span><span class="mord mathrm">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathrm">j</span><span class="mclose">]</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord"><span class="mord mathrm">dp</span></span><span class="mopen">[</span><span class="mord mathrm">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathrm">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">dp</span></span><span class="mopen">[</span><span class="mord mathrm">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathrm">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathrm">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathrm">j</span><span class="mclose">]}</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]}</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></div><div class="block-ref"><div class="decorator"></div><div id="c1aNhpZF4qhcVsgkwfcEsC" class="wolai-block wolai-text"><div><span class="inline-wrap">的动态规划问题</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="nafPRraEMt9pNeEEahAU1e" class="wolai-block wolai-text"><div><span class="inline-wrap">可以优化为：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="9f1ENfYfBjyfzG15fwBS7S" class="bg-blond wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></munder><mo stretchy="false">{</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">}</mo><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dp[i][ j]=\min _{s(i, j-1) \leq k \leq s(i+1, j)}\{dp[i][ k]+dp[k+1][ j]\}+cost(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight">s</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mopen">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]}</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></div></div><div class="block-ref"><div class="decorator"></div><h2 id="p94e2uMo5no5CXwDAGtWc1" class="wolai-block"><span class="inline-wrap">性能分析：</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="f9eVKKvmt2RTeT5bCNat7n" class="wolai-block wolai-text"><div><span class="inline-wrap">可以把</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">的算法进一步降低到</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="b74XmdanSdRTvwu9vfq1os" class="wolai-block wolai-text"><div><span class="inline-wrap">其实证明很简单，对于一个<span class="jill"></span>i，j<span class="jill"></span>来说，我们要<span class="jill"></span>for s[i][j-1]到<span class="jill"></span>s[i+1][j]个数，那么所有的<span class="jill"></span>i<span class="jill"></span>和<span class="jill"></span>j<span class="jill"></span>加起来一共会<span class="jill"></span>for<span class="jill"></span>多少次呢？
我们可以这样思考
(s[2][2]-[1][1])+(s[3][3]-s[2][2])+(s[4][4]-s[3][3])+…+(s[n][n]-s[n-1][n-1])=s[n][n]-s[1][1]很显然是小于<span class="jill"></span>n<span class="jill"></span>的嘛，所以本来是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">的复杂度，就这样降成了</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">啦</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="7xRRAkPoPxJFvUKrZNj2Xt" class="wolai-block wolai-text"><div><span class="inline-wrap">也就是我们对决策点的总枚举次数：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="brmZMMDx7jFPxE3bd6Fb1P" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>∑</mo><mrow><mn>1</mn><mo>≤</mo><mi>l</mi><mo>&lt;</mo><mi>r</mi><mo>≤</mo><mi>n</mi></mrow></munder><mi>s</mi><mtext>（</mtext><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>r</mi><mtext>）</mtext><mo>−</mo><mi>s</mi><mtext>（</mtext><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mtext>）</mtext><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>s</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>−</mo><mi>s</mi><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo>≤</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{1 \leq l&lt;r \leq n} s（l+1, r）-s（l, r-1）=\sum_{i=1}^{n} s(i, n)-s(1, i) \leq n^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4473em;vertical-align:-1.3973em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3973em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mord cjk_fallback">）</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></div></div><h2 id="sQGXfPa7EAh9i9JJkUGSM9" class="wolai-block"><span class="inline-wrap">测试：</span></h2><div class="block-ref"><div class="decorator"></div><div id="tR7FtDGGFi7GGZsRp2kMQv" class="wolai-block wolai-text"><div><span class="inline-wrap">算法<span class="jill"></span>1：区间动态规划</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="naHsHYsqoCARMTzhAwrwGX" class="wolai-block wolai-text"><div><span class="inline-wrap">算法<span class="jill"></span>2：带有四边形不等式优化的区间动态规划</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="jCTaxJRfu7C1dDdBbr1zET" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>方法：</b></span><span class="inline-wrap">随机生成一组矩阵，满足乘法规则（测试<span class="jill"></span>100<span class="jill"></span>个矩阵，500<span class="jill"></span>个矩阵，1000<span class="jill"></span>个矩阵）分别使用算法<span class="jill"></span>1<span class="jill"></span>和算法<span class="jill"></span>2<span class="jill"></span>解决上述问题，使用系统时钟测量各算法所需的实际时间，并进行比较。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="pQ19LrbcLCJqvKDCFACr2E" class="wolai-block wolai-text"><div><span class="inline-wrap">原引用已被删除。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="6odrB1PAcem2t7HUXJ6ZCm" class="wolai-block wolai-text"><div><span class="inline-wrap">原引用已被删除。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="dvEgXBcD9vTCTJTQzfpRRf" class="wolai-block wolai-text"><div><span class="inline-wrap">原引用已被删除。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="s8snqY2En18aL7K8xST3rE" class="wolai-block wolai-text"><div><span class="inline-wrap">原引用已被删除。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="mFuHSVyskALLvHQopTSvVY" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></div><h1 id="eBHXjr7bMrjV6BCg6QQgZc" class="wolai-block"><span class="inline-wrap">4.防卫导弹</span></h1><div class="block-ref"><div class="decorator"></div><div id="5jwaMJ7PFgaw3HADVqPuf5" class="wolai-bookmark wolai-block"><a href="https://www.luogu.com.cn/problem/P1020">[NOIP1999 普及组] 导弹拦截 - 洛谷</a><div class="info-box"><div class="text-pane"><div data-title="[NOIP1999 普及组] 导弹拦截 - 洛谷"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://www.luogu.com.cn/favicon.ico&quot;)"></div><div data-hostname="www.luogu.com.cn"></div></div></div><div class="preview-pane"></div></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="cJCqz3F4EwCgkXgDpcMx4r" class="wolai-block"><span class="inline-wrap">问题描述</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="c9QnbzxhXVJe56e9ueVuZm" class="wolai-block wolai-text"><div><span class="inline-wrap">某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：</span><span class="inline-wrap"><b>虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。</b></span><span class="inline-wrap">某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="6VCUALVEtusTuVfJTQsvgo" class="wolai-block wolai-text"><div><span class="inline-wrap">输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。</span></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="58kHqPnhzebL7YcSmZPx41" class="wolai-block"><span class="inline-wrap">算法思想</span></h2></div><div class="block-ref"><div class="decorator"></div><h3 id="hgb59HPX3FtFcGZRxS6FjU" class="wolai-block"><span class="inline-wrap">这套系统最多能拦截多少导弹？</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="gjWs5gacLaeDmnrZccrhKR" class="wolai-block wolai-text"><div><span class="inline-wrap">也就是求最长不下降子序列</span></div></div></div><div class="block-ref"><div class="decorator"></div><h3 id="wNBgXteNWs22Vz8nfYPdfM" class="wolai-block"><span class="inline-wrap">至少要配多少套这样的导弹拦截系统？</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="wvsdRuUr19akdbYwRW6WCj" class="wolai-block wolai-text"><div><span class="inline-wrap">这里我们需要使用：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="48h12P4qwPyhnMg31mneuW" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="https://www.wolai.com/48h12P4qwPyhnMg31mneuW"><span>Dilworth定理</span></a></div></div><div class="block-ref"><div class="decorator"></div><div id="fZojp1etXg4LvzHwSfGAcf" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>偏序集上最小链划分中链的数量等于其反链长度的最大值。</b></span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="a1152kiha35Ashd9P7c5CN" class="wolai-block wolai-text"><div><span class="inline-wrap">也就是：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="gqCsPWwKvLWxQ3eyiWY14E" class="bg-blond wolai-block wolai-text"><div><span class="inline-wrap"><b>最少的不上升子序列的个数就是最长上升子序列的长度。</b></span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="MKNk8EVLWq624CzNdQ5j3" class="wolai-block wolai-text"><div><span class="inline-wrap">所以这个问题就被转化为了最长上升序列长度</span></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="mZC2MQjXRqX5JFUxPfJ6vB" class="wolai-block"><span class="inline-wrap">DP</span></h2></div><div class="block-ref"><div class="decorator"></div><code-block id="oXwgyeLf7tj6EhwtMtAAnu" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>#include <span class="token operator">&lt;</span>bits<span class="token operator">/</span>stdc<span class="token operator">++</span><span class="token punctuation">.</span><span class="token property-access">h</span><span class="token operator">></span>
using namespace std<span class="token punctuation">;</span>
int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token comment">//  freopen("E:\\test.in","r",stdin);</span>
  int <span class="token keyword">in</span><span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  int dp<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  int dp1<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>dp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>dp1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>dp1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  int c<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">while</span><span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token keyword">in</span><span class="token punctuation">[</span>c<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  int ans<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  int ans1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  c<span class="token operator">--</span><span class="token punctuation">;</span>
  <span class="token comment">//计算最长不上增子序列 </span>
  <span class="token comment">//和计算最长严格递增子序列长度 </span>
  <span class="token comment">//这玩意儿还可以用二分搜索优化 </span>
  dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  dp1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>c<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>i<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>dp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        dp1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>dp1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>dp1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>dp1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
      dp1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    ans<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ans1<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>ans1<span class="token punctuation">,</span>dp1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  cout<span class="token operator">&lt;&lt;</span>ans<span class="token operator">&lt;&lt;</span>endl<span class="token operator">&lt;&lt;</span>ans1<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h3 id="pacEkTBq9YhDsJgU9sHVo6" class="wolai-block"><span class="inline-wrap">测试</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="g1Z9v9nGEuc8RP4u44ahBH" class="wolai-block wolai-text"><div><span class="inline-wrap">可以发现基础的<span class="jill"></span>DP<span class="jill"></span>模型解法超时严重</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="2YC6yGK4sFpEn9E1cAixeL" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_4.png" style="width: 100%"/></figure></div></div><div class="block-ref"><div class="decorator"></div><h2 id="eL83Pm5jm64YH8MTNXVeMH" class="wolai-block"><span class="inline-wrap">优化：Patience Sorting</span></h2></div><div class="block-ref"><div class="decorator"></div><blockquote id="gTvFu3iphfTUZhgwyhZHMo" class="wolai-block"><span class="inline-wrap">In </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Computer_science"><span>computer science</span></a></span><span class="inline-wrap">, </span><span class="inline-wrap"><b>patience sorting</b></span><span class="inline-wrap"> is a </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Sorting_algorithm"><span>sorting algorithm</span></a></span><span class="inline-wrap"> inspired by, and named after, the card game </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_(game)"><span>patience</span></a></span><span class="inline-wrap">. A variant of the algorithm efficiently computes the length of a </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Longest_increasing_subsequence"><span>longest increasing subsequence</span></a></span><span class="inline-wrap"> in a given </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Array_data_structure"><span>array</span></a></span><span class="inline-wrap">.</span><div id="atzt7MEAkhQ6NaHbg2zLJT" class="wolai-block wolai-text"><div><span class="inline-wrap">Patience sorting was named by C. L. Mallows, who attributed its invention to A.S.C. Ross in the early 1960s.</span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_sorting#cite_note-Chandramouli-1"><span>[1]</span></a></span><span class="inline-wrap"> According to Aldous and Diaconis,</span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_sorting#cite_note-Aldous-4"><span>[4]</span></a></span><span class="inline-wrap"> patience sorting was first recognized as an algorithm to compute the longest increasing subsequence length by Hammersley.</span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_sorting#cite_note-5"><span>[5]</span></a></span><span class="inline-wrap"> A.S.C. Ross and independently </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Robert_W._Floyd"><span>Robert W. Floyd</span></a></span><span class="inline-wrap"> recognized it as a sorting algorithm. Initial analysis was done by Mallows.</span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_sorting#cite_note-6"><span>[6]</span></a></span><span class="inline-wrap"> Floyd&#39;s game was developed by Floyd in correspondence with </span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Donald_Knuth"><span>Donald Knuth</span></a></span><span class="inline-wrap">.</span><span class="inline-wrap"><a href="https://en.wikipedia.org/wiki/Patience_sorting#cite_note-Burstein-2"><span>[2]</span></a></span></div></div></blockquote></div><ul class="wolai-block"><li id="sSBZ43HyrRqgzzuUJaVS39" class="block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>我们有一组数列：</mtext><mi>A</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo>=</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>12</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>14</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>13</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>11</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>15</mn></mrow></mrow><annotation encoding="application/x-tex">我们有一组数列：A[]={0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">我们有一组数列：</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">12</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">14</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">13</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">15</span></span></span></span></span></span><div class="decorator"></div></li><li id="5frr9KTewhZWAxXM8QWq4o" class="block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>我们的算法将会维护一组</mtext></mrow><annotation encoding="application/x-tex">我们的算法将会维护一组 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">我们的算法将会维护一组</span></span></span></span></span><span class="inline-wrap"><code>动态列表<span class="jill"></span>active lists</code></span><span class="inline-wrap"> </span><div class="decorator"></div></li><li id="t3M5YWnbmSYkYew42Kd3AY" class="block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>维护方式</mtext></mrow><annotation encoding="application/x-tex">维护方式</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">维护方式</span></span></span></span></span><span class="inline-wrap">：</span><div class="decorator"></div><ul class="wolai-block"><li id="nohcBxesMGeRibkaoGqfU"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>i</mi><mtext> </mtext><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mtext> </mtext><mn>1</mn><mtext> </mtext><mi>t</mi><mi>o</mi><mtext> </mtext><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">for \ i \ form\ 1\ to \ length(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal">i</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mspace"> </span><span class="mord">1</span><span class="mspace"> </span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></span><ol class="wolai-block"><li id="q9m5vDwfYTHJggMQBnxUyS"><div class="marker"></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>l</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mtext> </mtext><mi>a</mi><mi>m</mi><mi>o</mi><mi>n</mi><mi>g</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">if(A[i] \ is\ largest\ among\ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace"> </span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mspace"> </span><span class="mord mathnormal">am</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace"> </span></span></span></span></span><span class="inline-wrap"><code>all </code></span><span class="inline-wrap"><b><code>end</code></b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>f</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">of \ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span></span></span></span></span><span class="inline-wrap"><code>active lists</code></span><span class="inline-wrap">）</span><div id="6LexcvMsKq6HMd9V995yiM" class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>end</code></b></span><span class="inline-wrap">[length ++] = A[i]</span></div></div></li><li id="nhED94MPSh7zcAsrho5J3g"><div class="marker"></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mtext> </mtext><mi>i</mi><mi>s</mi><mtext> </mtext><mi>s</mi><mi>m</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>s</mi><mi>t</mi><mtext> </mtext><mi>a</mi><mi>m</mi><mi>o</mi><mi>n</mi><mi>g</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">if(A[i] \ is\ smallest\ among\ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace"> </span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mspace"> </span><span class="mord mathnormal">s</span><span class="mord mathnormal">ma</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mspace"> </span><span class="mord mathnormal">am</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace"> </span></span></span></span></span><span class="inline-wrap"><code>all </code></span><span class="inline-wrap"><b><code>end</code></b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>f</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">of \ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span></span></span></span></span><span class="inline-wrap"><code>active lists</code></span><span class="inline-wrap">）</span><div id="tPb1h68G6v9srCmQyVDMkP" class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>end</code></b></span><span class="inline-wrap">[1] = A[i]</span></div></div></li><li id="sX7nD6J2jpzZB6xtpa2dPD"><div class="marker"></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mi mathvariant="normal">&amp;</mi><mi mathvariant="normal">&amp;</mi><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">if\ (A[i]&lt;=end[j]\&amp;\&amp;A[i]&gt;end[j-1])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mord">&amp;&amp;</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">])</span></span></span></span></span><div id="exHbzXMN8ZtzcUKPj5S8qj" class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>end</code></b></span><span class="inline-wrap">[j]=A[i]</span></div></div></li></ol></li></ul></li></ul><div class="block-ref"><div class="decorator"></div><h2 id="2fp9T8KorHwUCx9bB2m6yF" class="wolai-block"><span class="inline-wrap">优化的优化：只留下</span><span class="inline-wrap"><code>end</code></span></h2></div><div class="block-ref"><div class="decorator"></div><div id="tgfyxH9KaQQhmF8nVWMxHD" class="wolai-block wolai-text"><div><span class="inline-wrap">我们观察这个算法可以发现，我们真正判断和修改的只有最后一位，也就是我们</span><span class="inline-wrap"><code>end</code></span><span class="inline-wrap">的那一列</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="cnEVgkYzhsMS9mWT3qsfBQ" class="wolai-block wolai-text"><div><span class="inline-wrap">前面的</span><span class="inline-wrap"><code>active lists</code></span><span class="inline-wrap">中真正有用的数据只有最后一组中记录的答案：一个最长上升子序列！但是很显然这个最长上升子序列并不唯一，我们会发现当我们读取</span><span class="inline-wrap"><code>end</code></span><span class="inline-wrap">数组时，这里面也记录了一个最长上升子序列</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="vpRZb3819fvJxiQhXGTuhx" class="wolai-block wolai-text"><div><span class="inline-wrap">也就是说，如果我们只需要得到</span><span class="inline-wrap"><code>LIS</code></span><span class="inline-wrap">的数量的话，或者只需要得到一组</span><span class="inline-wrap"><code>LIS</code></span><span class="inline-wrap">的话，我们只需要</span><span class="inline-wrap"><code>end</code></span><span class="inline-wrap">这个数组就够了！</span></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="8rBqT1WWGvzJ8oxmvS7mG9" class="wolai-block"><span class="inline-wrap">优化的优化的优化：二分查找</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="ieXrFCZ2c2wt7uk3JRzcMN" class="wolai-block wolai-text"><div><span class="inline-wrap">当我们在讨论我们的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mtext> </mtext><mn>3</mn></mrow><annotation encoding="application/x-tex">case \ 3
 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">se</span><span class="mspace"> </span><span class="mord">3</span></span></span></span></span><span class="inline-wrap">时，</span></div></div></div><ul class="wolai-block"><li id="kaxF8cqC7hBmsfCYLxNTb9" class="block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&lt;</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mi mathvariant="normal">&amp;</mi><mi mathvariant="normal">&amp;</mi><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">if\ (A[i]&lt;=end[j]\&amp;\&amp;A[i]&gt;end[j-1])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mord">&amp;&amp;</span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">])</span></span></span></span></span><div class="decorator"></div><div id="ja6GZSZh5ziWWBahq5evuv" class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>end</code></b></span><span class="inline-wrap">[j]=A[i]</span></div></div></li></ul><div class="block-ref"><div class="decorator"></div><div id="pv2aZgAogmQPKRPZQSK8Fi" class="wolai-block wolai-text"><div><span class="inline-wrap">我们实际上在寻找一个<span class="jill"></span>end[]中的第一个比这个数字大的数的位置，并且用<span class="jill"></span>A[i]去替换掉他，我们的</span><span class="inline-wrap"><code>二分查找</code></span><span class="inline-wrap">在找到或者找不到目标数的时候恰好可以做到这个能力！</span></div></div></div><div class="block-ref"><div class="decorator"></div><aside id="vEUgyDNjgpjJFGpnr7ARSc" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">但是这里希望读者可以注意到，二分查找同时具备找下界和找上界的能力，需要处理好这个细节！</span><div id="ng7rEmfcd8t4KcF8SuNckQ" class="wolai-block wolai-text"><div><span class="inline-wrap">这种写法确保了<span class="jill"></span>nums[l]&lt;k,而<span class="jill"></span>nums[r]≥k  </span></div></div><div id="uhHLpCtBbAKuPcQSkYd5Q6" class="wolai-block wolai-text"><div><span class="inline-wrap">[     小     ][       同        ][    大     ]</span></div></div><div id="nFEYmpeKokavEv9ZuTKPvt" class="wolai-block wolai-text"><div><span class="inline-wrap">              l r</span></div></div><div id="kn1kkyW6oXYBRi4R545GRd" class="wolai-block wolai-text"><div><span class="inline-wrap">而如果写成了<span class="jill"></span>v[m]&gt;key(也就是<span class="jill"></span>l<span class="jill"></span>的条件换成了<span class="jill"></span>v[m]≤key</span></div></div><div id="5m6qhN8ZWvkSmwKUEPMH1d" class="wolai-block wolai-text"><div><span class="inline-wrap">那么 nums[l]≤k nums[r]&gt;k</span></div></div><div id="spsK9pgLrrgKHKcdorrZeM" class="wolai-block wolai-text"><div><span class="inline-wrap">[     小     ][       同        ][    大     ]</span></div></div><div id="bRT1UxdVRCEQiUsmzx87E3" class="wolai-block wolai-text"><div><span class="inline-wrap">                                  l r</span></div></div><div id="phoZgSH6ND57ZhzBBTe59r" class="wolai-block wolai-text"><div><span class="inline-wrap">就变成找右边界了</span></div></div><div id="wmkcjRmzaag4y4J8iAUonR" class="wolai-block wolai-text"><div><span class="inline-wrap">其中<span class="jill"></span>r-l&gt;1<span class="jill"></span>很重要 确保了可以退出</span></div></div></aside></div><div class="block-ref"><div class="decorator"></div><code-block id="aJXtWJyDW5HCuzvvbfMmnf" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token function"><span class="token maybe-class-name">CeilIndex</span></span><span class="token punctuation">(</span><span class="token parameter">std<span class="token operator">:</span><span class="token operator">:</span>vector<span class="token operator">&lt;</span>int<span class="token operator">></span><span class="token operator">&amp;</span> v<span class="token punctuation">,</span> int l<span class="token punctuation">,</span> int r<span class="token punctuation">,</span> int key</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span>
    int m <span class="token operator">=</span> <span class="token punctuation">(</span>l<span class="token operator">+</span>r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">>=</span> key<span class="token punctuation">)</span>
      r <span class="token operator">=</span> m<span class="token punctuation">;</span>
    <span class="token keyword control-flow">else</span>
      l <span class="token operator">=</span> m<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h2 id="hUgU4xsXDMroPexas1s3fv" class="wolai-block"><span class="inline-wrap">优化后代码</span></h2></div><div class="block-ref"><div class="decorator"></div><code-block id="5qsL1gC7D6cq9UG3k9LWg9" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>#include <span class="token operator">&lt;</span>bits<span class="token operator">/</span>stdc<span class="token operator">++</span><span class="token punctuation">.</span><span class="token property-access">h</span><span class="token operator">></span>
using namespace std<span class="token punctuation">;</span>
int <span class="token keyword">in</span><span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int end1<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int end2<span class="token punctuation">[</span><span class="token number">100010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int <span class="token function"><span class="token maybe-class-name">CeilIndex1</span></span><span class="token punctuation">(</span><span class="token parameter">int end<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> int l<span class="token punctuation">,</span> int r<span class="token punctuation">,</span> int x</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    int mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">>=</span> x<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            r <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">else</span>
        <span class="token punctuation">{</span>
            l <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token function"><span class="token maybe-class-name">CeilIndex2</span></span><span class="token punctuation">(</span><span class="token parameter">int end<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> int l<span class="token punctuation">,</span> int r<span class="token punctuation">,</span> int x</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    int mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> l <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">>=</span> x<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            l <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">else</span>
        <span class="token punctuation">{</span>
            r <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//  freopen("E:\\test.in","r",stdin);</span>


    int c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">in</span><span class="token punctuation">[</span><span class="token operator">++</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    c<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//这个很灵性呢</span>

    <span class="token comment">//也就是 优化算法，求最长上升子序列 和 最长不升子序列</span>
    end1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> end2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    int c1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    int c2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> c<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> end1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            end1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> end1<span class="token punctuation">[</span>c1<span class="token punctuation">]</span><span class="token punctuation">)</span>
            end1<span class="token punctuation">[</span><span class="token operator">++</span>c1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">else</span>
            end1<span class="token punctuation">[</span><span class="token function"><span class="token maybe-class-name">CeilIndex1</span></span><span class="token punctuation">(</span>end1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> c1<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> end2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            end2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> end2<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token punctuation">)</span>
            end2<span class="token punctuation">[</span><span class="token operator">++</span>c2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">else</span>
            end2<span class="token punctuation">[</span><span class="token function"><span class="token maybe-class-name">CeilIndex2</span></span><span class="token punctuation">(</span>end2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">in</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> c2 <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> c1<span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h3 id="aWgQVbUybHcSMdJU3fgCwe" class="wolai-block"><span class="inline-wrap">OJ<span class="jill"></span>测试</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="2Tm7cSK1uat89gCaJEiZG4" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_5.png" style="width: 100%"/></figure></div></div><h1 id="r9VrRpSjvRNQjtAQJQ48aL" class="wolai-block"><span class="inline-wrap">5.皇宫看守</span></h1><div class="block-ref"><div class="decorator"></div><h2 id="bMoHFEqbFCquY3wLeVfSDD" class="wolai-block"><span class="inline-wrap">OJ<span class="jill"></span>地址:</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="ksjcSfGgxScJbXFaPvDCaj" class="wolai-bookmark wolai-block"><a href="http://ybt.ssoier.cn:8088/problem_show.php?pid=1579">http://ybt.ssoier.cn:8088/problem_show.php?pid=1579</a><div class="info-box"><div class="text-pane"><div data-title="ybt.ssoier.cn"></div><div class="icon-host"><div data-hostname="ybt.ssoier.cn"></div></div></div><div class="preview-pane"></div></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="497YN2jMHZt3uMvbfzGs5d" class="wolai-block"><span class="inline-wrap">问题重述：</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="7o8z81pWz6QfvR46vhQVtj" class="wolai-block wolai-text"><div><span class="inline-wrap">太平王世子事件后，陆小凤成了皇上特聘的御前一品侍卫。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="9mbFU4HdDJ83J2VNG7RiYT" class="wolai-block wolai-text"><div><span class="inline-wrap">皇宫以午门为起点，直到后宫嫔妃们的寝宫，呈一棵树的形状，某些宫殿间可以互相望见。大内保卫森严，三步一岗，五步一哨，每个宫殿都要有人全天候看守，在不同的宫殿安排看守所需的费用不同。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="uAyTJmfmvUfDZ2WnEiqogf" class="wolai-block wolai-text"><div><span class="inline-wrap">可是陆小凤手上的经费不足，无论如何也没法在每个宫殿都安置留守侍卫。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="uLTDsNLRbZeWwNNsnp4FgK" class="wolai-block wolai-text"><div><span class="inline-wrap">帮助陆小凤布置侍卫，在看守全部宫殿的前提下，使得花费的经费最少。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="iCPtMYfDPM5NGLc7GN8Z9u" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_6.png" style="width: 143.2px"/></figure></div></div><div class="block-ref"><div class="decorator"></div><h2 id="c11TfrtJkLCzXhN2AYH5WC" class="wolai-block"><span class="inline-wrap">输入：</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="toobCy8dfTDhS2ZvuGfZTp" class="wolai-block wolai-text"><div><span class="inline-wrap">输入中数据描述一棵树，描述如下：</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="5DGHVuyQdkn6imNUDBKme2" class="wolai-block wolai-text"><div><span class="inline-wrap">第一行 n，表示树中结点的数目。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="hcb3ZHzcFVawZ2tnQ7Py6N" class="wolai-block wolai-text"><div><span class="inline-wrap">第二行至第<span class="jill"></span>n+1 行，每行描述每个宫殿结点信息，依次为：该宫殿结点标号 i(0&lt;i≤n)，在该宫殿安置侍卫所需的经费 k，</span><span class="inline-wrap"><b>该边的儿子数 m</b></span><span class="inline-wrap">，接下来 m 个数，分别是这个节点的 m 个儿子的标号<span class="jill"></span>r1,r2,⋯,rm。</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="eV3ceb6dumaAyrTUGETymG" class="wolai-block wolai-text"><div><span class="inline-wrap">对于一个 n 个结点的树，结点标号在 1 到 n 之间，且标号不重复。</span></div></div></div><div class="block-ref"><div class="decorator"></div><code-block id="xcSC7FyhJLMgyNTHTcc9nH" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre><span class="token number">8</span>
<span class="token number">1</span> <span class="token number">100</span> <span class="token number">3</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span>
<span class="token number">2</span> <span class="token number">100</span> <span class="token number">3</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span>
<span class="token number">3</span> <span class="token number">1</span> <span class="token number">0</span>
<span class="token number">4</span> <span class="token number">2</span> <span class="token number">0</span>
<span class="token number">5</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">8</span>
<span class="token number">6</span> <span class="token number">2</span> <span class="token number">0</span> 
<span class="token number">7</span> <span class="token number">100</span> <span class="token number">0</span>
<span class="token number">8</span> <span class="token number">100</span> <span class="token number">0</span></pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h2 id="urzXPTHn2xHjFU7ZH3MLue" class="wolai-block"><span class="inline-wrap">输出：</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="3NrrTQdqcrsi6ZFcKWvhgS" class="wolai-block wolai-text"><div><span class="inline-wrap">输出最少的经费</span></div></div></div><div class="block-ref"><div class="decorator"></div><code-block id="mjrQ7wg4oNGJ8KA7VUQSUw" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre><span class="token number">104</span></pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h2 id="hck5WgkDwbC4kEq2z6BYe4" class="wolai-block"><span class="inline-wrap">数据结构</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="so9UsGAUfGWT2N63RWESFm" class="wolai-block wolai-text"><div><span class="inline-wrap">直接邻接矩阵存树</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="bkVAstu6dKg2eFT948Cm4r" class="wolai-block wolai-text"><div><span class="inline-wrap">并且存成有向图</span></div></div></div><div class="block-ref"><div class="decorator"></div><h2 id="kbaMpXmQrwDXfNgf7sUdsu" class="wolai-block"><span class="inline-wrap">算法分析：</span></h2></div><div class="block-ref"><div class="decorator"></div><aside id="nfFfY94zH8CBz2s1BpuPPU" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">理解了一下，就是求树上的最小支配？</span><div id="snsXu6gf3eU8ATs4mxU6Sz" class="wolai-block wolai-text"><div><span class="inline-wrap">好像不太对</span></div></div></aside></div><div class="block-ref"><div class="decorator"></div><hr id="mXiAvRVT8QgLHik18hZdxa" class="wolai-block"/></div><div class="block-ref"><div class="decorator"></div><div id="5Tv9xkrNC4i2V6uiUo4QEQ" class="wolai-block wolai-text"><div><span class="inline-wrap">可以转换成二分图 然后点着色吗？</span></div></div></div><div class="block-ref"><div class="decorator"></div><hr id="oZpDGpVPRBVsm4UTYnKnTE" class="wolai-block"/></div><div class="block-ref"><div class="decorator"></div><h3 id="eSC1uaEjb91p4o1vFGnAMU" class="wolai-block"><span class="inline-wrap">贪心搜索</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="7hxBRtM5bkyyCgosPFDiXg" class="wolai-block wolai-text"><div><span class="inline-wrap">考虑一棵树</span></div></div></div><div class="block-ref"><div class="decorator"></div><div id="4MuW11JJzxFHRFh18V9AKv" class="wolai-block wolai-text"><div><span class="inline-wrap">1.要所有的孩子</span></div><div id="mBddePg1bHzRqoQzCJ4CAV" class="wolai-block wolai-text"><div><span class="inline-wrap">孩子的孩子就不要了，要他们的孩子 也就是孩子的孩子的孩子</span></div></div></div></div><div class="block-ref"><div class="decorator"></div><div id="u59fZnGhLQ3Jr92A61sYn" class="wolai-block wolai-text"><div><span class="inline-wrap">2.要父亲</span></div><div id="HsWMMwbYURZ8pzn8zLKX5" class="wolai-block wolai-text"><div><span class="inline-wrap">要孩子的孩子</span></div></div></div></div><div class="block-ref"><div class="decorator"></div><code-block id="uWr9c3QUA52BPyRHPnAJbr" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>#include <span class="token operator">&lt;</span>bits<span class="token operator">/</span>stdc<span class="token operator">++</span><span class="token punctuation">.</span><span class="token property-access">h</span><span class="token operator">></span>
#define <span class="token constant">INF</span> <span class="token number">0x3f3f3f</span>
using namespace std<span class="token punctuation">;</span>
int n<span class="token punctuation">;</span>
int g<span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//应该是自下而上的 </span>
<span class="token comment">//但是我这里先编一个自上而下的</span>
int <span class="token function">search</span><span class="token punctuation">(</span><span class="token parameter">int x</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  int minn<span class="token operator">=</span><span class="token constant">INF</span><span class="token punctuation">;</span>
  int ans<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">//要所有的孩子 </span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      ans<span class="token operator">+=</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
          ans<span class="token operator">+=</span><span class="token function">search</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  minn<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>minn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//要父亲</span>
  ans<span class="token operator">=</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
      ans<span class="token operator">+=</span><span class="token function">search</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> 
  minn<span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span>minn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//  cout&lt;&lt;1&lt;&lt;endl;</span>
  <span class="token keyword control-flow">return</span> minn<span class="token punctuation">;</span>
 <span class="token punctuation">}</span> 
 int <span class="token function">findroot</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span>
   <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
     <span class="token comment">//只有出度没有入度的就是树根</span>
    int t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        t<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>t<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> n<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cin<span class="token operator">>></span>n<span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    int k<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>k<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>g<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">>></span>m<span class="token punctuation">;</span>
    <span class="token comment">//在k,0位置储存花费 </span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      int t<span class="token punctuation">;</span>
      cin<span class="token operator">>></span>t<span class="token punctuation">;</span>
      g<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//  g[t][k]=1;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//输入树 其实当图来存了呢 </span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span>g<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">else</span>
  <span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token function">findroot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</pre></div></code-block></div><div id="i1sTvFFA6QsPyE3jRM2wo" class="wolai-block wolai-text"><div></div></div><div class="block-ref"><div class="decorator"></div><div id="6sFgxLedGhbw3gWYKmdiaY" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_7.png" style="width: 100%"/></figure></div></div><div class="block-ref"><div class="decorator"></div><h2 id="aGiGnCkskMbuqMAUQhcyMo" class="wolai-block"><span class="inline-wrap">树形<span class="jill"></span>DP</span></h2></div><div class="block-ref"><div class="decorator"></div><h3 id="22Snhroir6BmNV2GHLxVGh" class="wolai-block"><span class="inline-wrap">状态定义</span></h3></div><div class="block-ref"><div class="decorator"></div><h4 id="nFmaJbd5eyjYmHzqzH7Q6d" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][0]</code></b></span></h4></div><div class="block-ref"><div class="decorator"></div><div id="hKpoNLD8J1BqTpiLiRK82i" class="wolai-block wolai-text"><div><span class="inline-wrap">第<span class="jill"></span>u<span class="jill"></span>号结点</span><span class="inline-wrap"><b>没有放守卫</b></span><span class="inline-wrap">，并且第<span class="jill"></span>u<span class="jill"></span>号结点被他的</span><span class="bg-uranian_blue inline-wrap">父结点</span><span class="inline-wrap">安排的守卫看住的方案 最小值</span></div></div></div><div class="block-ref"><div class="decorator"></div><h4 id="9KiwjBthZA2BvX3eRcnN7C" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][1]</code></b></span></h4></div><div class="block-ref"><div class="decorator"></div><div id="xnApkSd6bJ7jfUoMEuJxzG" class="wolai-block wolai-text"><div><span class="inline-wrap">第<span class="jill"></span>u<span class="jill"></span>号结点没有放守卫，并且第<span class="jill"></span>u<span class="jill"></span>号结点被他的</span><span class="bg-uranian_blue inline-wrap">子结点</span><span class="inline-wrap">安排的守卫看住的方案 最小值</span></div></div></div><div class="block-ref"><div class="decorator"></div><h4 id="vnGVLD8jpirSRENFV5LGk1" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][2]</code></b></span></h4></div><div class="block-ref"><div class="decorator"></div><div id="9U6HJUEYuxaRVwSWQetxGh" class="wolai-block wolai-text"><div><span class="inline-wrap">第<span class="jill"></span>u<span class="jill"></span>号结点</span><span class="bg-uranian_blue inline-wrap">自己</span><span class="inline-wrap">安排守卫看住的方案 最小值</span></div></div></div><div class="block-ref"><div class="decorator"></div><h3 id="hX5yBC8wvUfN2457YMBtHK" class="wolai-block"><span class="inline-wrap">Base Case</span></h3></div><div class="block-ref"><div class="decorator"></div><h4 id="aRSBf1uBiixSVSvoffqsLd" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][0]</code></b></span><span class="inline-wrap"> = 0;    </span></h4></div><div class="block-ref"><div class="decorator"></div><div id="rCnKu1T7cVNdUtYQMcM5a3" class="wolai-block wolai-text"><div><span class="inline-wrap"> u<span class="jill"></span>点由父亲看着，</span><span class="inline-wrap"><b>此状态从<span class="jill"></span>u<span class="jill"></span>点为根的子树来看，代价为<span class="jill"></span>0。</b></span></div></div></div><div class="block-ref"><div class="decorator"></div><h4 id="awPYhs4oStF28r8T5JCxqr" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][1]</code></b></span><span class="inline-wrap"> = INF;  </span></h4></div><div class="block-ref"><div class="decorator"></div><div id="76s2XBbZ7xaKUSY54msTft" class="wolai-block wolai-text"><div><span class="inline-wrap"> u<span class="jill"></span>被某个子节点看守，但还没有评选中由哪个来看守更合适，初始值是<span class="jill"></span>INF</span></div></div></div><div class="block-ref"><div class="decorator"></div><h4 id="qUmrbPRGeDgNEyDNF4XE3n" class="wolai-block"><span class="bg-blond inline-wrap"><b><code>f[u][2]</code></b></span><span class="inline-wrap"> = w[u]; </span></h4></div><div class="block-ref"><div class="decorator"></div><div id="fYM2wvKeXYSrcMLTKTbBBB" class="wolai-block wolai-text"><div><span class="inline-wrap"> u<span class="jill"></span>点由自己看着，此状态从<span class="jill"></span>u<span class="jill"></span>点为根的子树来看，代价为<span class="jill"></span>w[u]。</span></div></div></div><div class="block-ref"><div class="decorator"></div><hr id="hXrPBL3bWKvpCLjhTNsuU5" class="wolai-block"/></div><div class="block-ref"><div class="decorator"></div><aside id="emcMsjnMijs8wEMipWZ47m" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">这里都还没有算上 自己的孩子被看住的代价，会在后面更新加上的 </span></aside></div><div class="block-ref"><div class="decorator"></div><h3 id="E2kM3wsJHJetsEgynxdJh" class="wolai-block"><span class="inline-wrap">状态转移方程</span></h3></div><div class="block-ref"><div class="decorator"></div><div id="rEajc7wBDaGskcuorYPdWp" class="wolai-block wolai-text"><div><span class="bg-blond inline-wrap"><b>对于当前结点</b></span><span class="bg-blond inline-wrap"><b><code>u</code></b></span><span class="inline-wrap">，</span><span class="bg-blond"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">
j </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="bg-blond inline-wrap"><b>是</b></span><span class="bg-blond"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span><span class="bg-blond inline-wrap"><b>的儿子的标号</b></span></div></div></div><ul class="wolai-block"><li id="uzKp6drKCxBHWosiFF37MU" class="bg-default block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="bg-blond inline-wrap"><b>不放守卫</b></span><div class="decorator"></div><ol class="wolai-block"><li id="gqXhiuxTDE1nK5hp4KjJ8u"><div class="marker"></div><span class="bg-blond inline-wrap"><b>父结点放了，记</b></span><span class="bg-blond inline-wrap"><b><code>f[u][0]</code></b></span><span class="bg-uranian_blue"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mo>∑</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">
f[u][0]=∑min\{f[j][1],f[j][2]\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]}</span></span></span></span></span><div id="iGKu4QDwhYBUNWf2w3i5MD" class="wolai-block wolai-text"><div><span class="inline-wrap">含义：当前结点</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">不放且被父节点看到，那么子结点</span><span class="inline-wrap"><code>j</code></span><span class="inline-wrap">只能放或者被其子结点看到。</span></div></div><div id="7G72Ur8B9r2nZXWfrGwRwn" class="wolai-block wolai-text"><div><span class="inline-wrap">因为</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">不放所以不能拿</span><span class="inline-wrap"><code>f[j][0]</code></span><span class="inline-wrap">来更新</span></div></div></li><li id="3DQsZdCJjTgNcH3pgv3aKk"><div class="marker"></div><span class="bg-blond inline-wrap"><b>子节点放了，记</b></span><span class="bg-blond inline-wrap"><b><code>f[u][1]</code></b></span><span class="bg-uranian_blue"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mo>∑</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">}</mo><mspace width="1em"/><mi>k</mi><mo mathvariant="normal">≠</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">f[u][1]=f[k][2]+\sum \min \{f[j][1], f[j][2]\} \quad k \neq j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]}</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span><div id="943qJz2ESVQa4gsrJvFKk" class="wolai-block wolai-text"><div><span class="inline-wrap">含义：</span></div></div><div id="aHhgaHj6VdxSUymhEUv9uE" class="wolai-block wolai-text"><div><span class="inline-wrap">如果当前结点<span class="jill"></span>u<span class="jill"></span>没用放，u<span class="jill"></span>的父节点也没放，那么<span class="jill"></span>u<span class="jill"></span>至少有一个子结点（k）放了</span></div></div><div id="6v9qUymagsrWQvvWnk1p6Y" class="wolai-block wolai-text"><div><span class="inline-wrap">当前结点</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">不放，</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">的子结点</span><span class="inline-wrap"><code>k</code></span><span class="inline-wrap">放了，</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">的其他子结点</span><span class="inline-wrap"><code>j</code></span><span class="inline-wrap">放（</span><span class="inline-wrap"><code>f[j][2]</code></span><span class="inline-wrap">）或者不放（即</span><span class="inline-wrap"><code>f[j][1]</code></span><span class="inline-wrap">）。没有</span><span class="inline-wrap"><code>f[j][0]</code></span><span class="inline-wrap">的原因也是因为</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">不放，且需要枚举</span><span class="inline-wrap"><code>k</code></span><span class="inline-wrap">。</span></div></div><hr id="7oMU9KXA5K6tH7Yyy1mzsw" class="wolai-block"/><div id="hjciWNRMJymWB7XTb9jVvH" class="wolai-block wolai-text"><div><span class="inline-wrap">这里为了简化重复计算，采取另一种计算方法</span></div></div><div id="iz6FdKTdNhSUe7JeiRtudj" class="wolai-block wolai-text"><div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mo>∑</mo><mo stretchy="false">{</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">f[u][1]=min\{f[k][2]+\sum\{min(f[j][1],f[j][2])\} - min(f[k][1],f[k][2])\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mopen">{</span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">])}</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">])}</span></span></span></span></span></div></div><div id="imYxQnU8YpfhiyvMkxfPQT" class="wolai-block wolai-text"><div><span class="inline-wrap">这里可以有</span><span class="bg-uranian_blue"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mo>∑</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">
f[u][0]=∑min\{f[j][1],f[j][2]\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]}</span></span></span></span></span></div></div><div id="b91pzShsPQpn1E6edRHbb4" class="wolai-block wolai-text"><div><span class="inline-wrap">那么：</span></div></div><div id="dBfPCF6SFEanRXpzWyZJJG" class="wolai-block wolai-text"><div><span class="bg-uranian_blue"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>+</mo><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">
f[u][1]=min\{f[k][2]+f[u][0] - min(f[k][1],f[k][2])\} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">])}</span></span></span></span></span></div></div></li></ol></li><li id="85XSnSBNTAS6DDf8ounmLX" class="block-ref"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="bg-blond inline-wrap"><b>放置守卫，记</b></span><span class="bg-blond inline-wrap"><b><code>f[u][2]</code></b></span><span class="bg-blond inline-wrap"><b>  </b></span><span class="bg-uranian_blue"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo>=</mo><mi>w</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mo>+</mo><mo>∑</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">{</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">f[u][2]=w[u]+\sum \min \{f[j][0], f[j][1], f[j][2]\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]}</span></span></span></span></span><div class="decorator"></div><div id="gSu4MbWZj9qvwgMQtmnZLa" class="wolai-block wolai-text"><div><span class="inline-wrap">含义：当前结点放了，那么子结点取哪种状态都可以</span></div></div></li></ul><div class="block-ref"><div class="decorator"></div><h3 id="gvmRYwSwaynZDB1EEFiC4b" class="wolai-block"><span class="inline-wrap">代码：</span></h3></div><div class="block-ref"><div class="decorator"></div><code-block id="eVBnsQpmKZxupNCabLRthc" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>#include <span class="token operator">&lt;</span>bits<span class="token operator">/</span>stdc<span class="token operator">++</span><span class="token punctuation">.</span><span class="token property-access">h</span><span class="token operator">></span>
#define <span class="token constant">INF</span> <span class="token number">0x3f3f3f</span>
using namespace std<span class="token punctuation">;</span>
int n<span class="token punctuation">;</span>
int g<span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int f<span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int <span class="token keyword">in</span><span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//记录入度 </span>
int w<span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
int flag<span class="token punctuation">[</span><span class="token number">1510</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token parameter">int u</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">search</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//先把儿子要求的值先求了</span>
      f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+=</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>   
  <span class="token punctuation">}</span>
  flag<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memset</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">sizeof</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cin<span class="token operator">>></span>n<span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    int k<span class="token punctuation">,</span>m<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>k<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>w<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">>></span>m<span class="token punctuation">;</span>
    <span class="token comment">//输入树 其实当图来存了呢 </span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      int t<span class="token punctuation">;</span>
      cin<span class="token operator">>></span>t<span class="token punctuation">;</span>
      g<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">in</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//记录入度 这是为了后面求根方便做的 </span>
    <span class="token comment">//  g[t][k]=1; //存的是单向图 </span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//初始化base case </span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">INF</span><span class="token punctuation">;</span>
    f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
  int r<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">while</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> r<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//找根</span>
  <span class="token function">search</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
  cout<span class="token operator">&lt;&lt;</span><span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> </pre></div></code-block></div><div class="block-ref"><div class="decorator"></div><h2 id="9jUfKDz2xH3VEkrDeEPwLu" class="wolai-block"><span class="inline-wrap">OJ<span class="jill"></span>测试结果</span></h2></div><div class="block-ref"><div class="decorator"></div><div id="nr6SHd4w9hBGT6FbLU7kiS" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_8.png" style="width: 601.6px"/></figure></div></div></article><footer></footer></body></html>