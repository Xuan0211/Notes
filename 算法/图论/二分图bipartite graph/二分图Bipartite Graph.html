<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>二分图Bipartite Graph - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div data-symbol="✨" class="icon"></div></div><div data-title="二分图Bipartite Graph" class="main-title"></div></div></header><article><div id="aK4dMRQPWgnETyhB6dsjdB" class="wolai-bookmark wolai-block"><a href="https://blog.nowcoder.net/n/0e9a713d93f54bc79739588e928f091a">二分图详解_牛客博客</a><div class="info-box"><div class="text-pane"><div data-title="二分图详解_牛客博客"></div><div data-desc="       本篇博客主要讲解什么是二分图，怎样判断二分图，匈牙利算法和HK(Hopcroft-Karp)算法，以及二分图多重匹配。  二分图定义：         二分图又称作二部图，是图论中的一种"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://blog.nowcoder.net/favicon.ico&quot;)"></div><div data-hostname="blog.nowcoder.net"></div></div></div><div class="preview-pane"></div></div></div><h1 id="d7Ao44anBJVvK57RyaYQdA" class="wolai-block"><span class="inline-wrap">定义：</span></h1><blockquote id="5xJYSwria8PuXtQwxK8gG5" class="wolai-block"><span class="inline-wrap">二分图又称作二部图，是图论中的一种特殊模型。</span></blockquote><blockquote id="bqcz3oof7YX7VXR5YDAnDy" class="wolai-block"><span class="inline-wrap">设<span class="jill"></span>G=(V,E)是一个</span><span class="inline-wrap"><b><code>无向图</code></b></span><span class="inline-wrap">。如果顶点集 V<span class="jill"></span>可分割为两个互不相交的子集<span class="jill"></span>X<span class="jill"></span>和<span class="jill"></span>Y，并且图中每条边连接的两个顶点一个在 X<span class="jill"></span>中，另一个在<span class="jill"></span>Y<span class="jill"></span>中，则称图<span class="jill"></span>G<span class="jill"></span>为二分图。</span></blockquote><h1 id="vNq5vH8iDt4LpH18y9kY3P" class="wolai-block"><span class="inline-wrap">性质</span></h1><blockquote id="v1Kdp1wWsUfFvFtd3phSvZ" class="wolai-block"><span class="inline-wrap">当且仅当无向图<span class="jill"></span>G<span class="jill"></span>的</span><span class="inline-wrap"><b>每一个环的结点数均是偶数时</b></span><span class="inline-wrap">，图<span class="jill"></span>G<span class="jill"></span>才是一个二分图。</span></blockquote><blockquote id="2NedoiM43Fi4uFXPp1nStp" class="wolai-block"><span class="inline-wrap">如果无环，相当于每的结点数为<span class="jill"></span>0，故也视为二分图</span></blockquote><div id="53VvXMXvwPSZF1umYVuqPU" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image.png" style="width: 100%"/></figure></div><h1 id="vz6z5fb8DJWeEHGZbvfLjs" class="wolai-block"><span class="inline-wrap">判定</span></h1><h2 id="kXAqNNF9s4nQFjpN29h1ZV" class="wolai-block"><span class="inline-wrap">充要</span></h2><div id="2XdyscZSfvGVztvKC8LFup" class="wolai-block wolai-text"><div><span class="inline-wrap">A graph is bipartite if and only if it does not contain any odd cycles</span></div></div><h2 id="tqYJ1KfJrpMaSizUsnDbLU" class="wolai-block"><span class="inline-wrap">染色法</span></h2><blockquote id="6xHrDBTrPS4kkRTP1PAYeM" class="wolai-block"><span class="inline-wrap">中南大学考研最喜欢的题目之一</span></blockquote><div id="3QAB74mrFaom5FusbXLPr" class="wolai-block wolai-text"><div><span class="inline-wrap">如果一个图是连通的，可</span><span class="inline-wrap"><code>染色法</code></span><span class="inline-wrap">判定是否二分图：</span></div></div><div id="vCTx7t1a8byvYPXLArgfqx" class="wolai-block wolai-text"><div><span class="inline-wrap">【假设】把</span><span class="inline-wrap"><code>X<span class="jill"></span>部</code></span><span class="inline-wrap">的结点颜色设为</span><span class="inline-wrap"><code>0</code></span><span class="inline-wrap">，</span><span class="inline-wrap"><code>Y<span class="jill"></span>部</code></span><span class="inline-wrap">的颜色设为</span><span class="inline-wrap"><code>1</code></span><span class="inline-wrap">。</span></div></div><ul class="wolai-block"><li id="saexutQ6eAcPgrnZ7ZDRa1"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">从某个未染色的结点</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">开始，做</span><span class="inline-wrap"><code>BFS</code></span><span class="inline-wrap">或者</span><span class="inline-wrap"><code>DFS</code></span><span class="inline-wrap">。</span></li><li id="f1YtpD1a48qHoLLHLjWJdk"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">把</span><span class="inline-wrap"><code>u</code></span><span class="inline-wrap">染为</span><span class="inline-wrap"><code>0</code></span><span class="inline-wrap">，枚举<span class="jill"></span>u<span class="jill"></span>的</span><span class="inline-wrap"><code>儿子<span class="jill"></span>v</code></span><span class="inline-wrap">。</span><ul class="wolai-block"><li id="ubAU9TpYZ7Nk4u9o8ZmDTn"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">如果</span><span class="inline-wrap"><code>未染色</code></span><span class="inline-wrap">，就染为与<span class="jill"></span>u</span><span class="inline-wrap"><code>相反</code></span><span class="inline-wrap">的颜色，</span></li><li id="je7L1gsWBi8ZwFjwg8TfFF"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">如果</span><span class="inline-wrap"><code>已染色</code></span><span class="inline-wrap">，则判断<span class="jill"></span>u<span class="jill"></span>与<span class="jill"></span>v<span class="jill"></span>的颜色是否相同，相同则不是二分图。</span></li></ul></li><li id="fkiMh4xBCnKCq5YXzeyMBn"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">如果一个图不连通，则在每个</span><span class="inline-wrap"><code>连通块</code></span><span class="inline-wrap">中作判定。</span></li></ul><div id="2knNagdwUzvzKUNPbn1iv9" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_1.png" style="width: 318.117243928373px"/></figure></div><aside id="goDTXFX25ajPX7mfaviUZV" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">也就是说，同一部的顶点之间不应该有边</span></aside><h3 id="5JPRLVicDWD2z1XHe8A7MM" class="wolai-block"><span class="inline-wrap">存储结构：无向图</span></h3><code-block id="bKpR1bytDRJAXTLhSGrdZn" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>struct <span class="token maybe-class-name">Edge</span>
<span class="token punctuation">{</span>
    int to<span class="token punctuation">;</span>
    <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    int w<span class="token punctuation">;</span><span class="token comment">//权值 这个属性虽然没有用上</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">UndirectedGraph</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    int n<span class="token punctuation">;</span>
    <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> head<span class="token punctuation">[</span><span class="token constant">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//头也是指针</span>
    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">int n<span class="token punctuation">,</span>int e</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//n代表节点的个数，e代表边的条数</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>n <span class="token operator">=</span> n<span class="token punctuation">;</span>
        <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            head<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//初始化</span>
            head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
            head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>e<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            int s<span class="token punctuation">,</span> t<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> s <span class="token operator">>></span> t<span class="token punctuation">;</span>
            <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now1<span class="token punctuation">;</span>
            <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now2<span class="token punctuation">;</span>
            now1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            now2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            now1<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> t<span class="token punctuation">;</span>
            now2<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> s<span class="token punctuation">;</span>
            <span class="token comment">//头插法插入边</span>
            now1<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span>
            now2<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> now1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> now2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre></div></code-block><h3 id="aE9PCKJBzU47FcAwXjjP58" class="wolai-block"><span class="inline-wrap">判定函数</span></h3><code-block id="qS1VkwyiYHDtATpb2eKKKg" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>bool <span class="token constant">DFS</span><span class="token punctuation">(</span><span class="token parameter"><span class="token maybe-class-name">UndirectedGraph</span> <span class="token constant">G</span><span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>int<span class="token operator">></span><span class="token operator">&amp;</span> color<span class="token punctuation">,</span> int v</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//对联通子图进行染色检查</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now <span class="token operator">=</span> <span class="token constant">G</span><span class="token punctuation">.</span><span class="token property-access">head</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span> now <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> now <span class="token operator">=</span> now<span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>color<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//如果是一个没有被访问过的边：染上新的颜色 并继续递归</span>
        <span class="token punctuation">{</span>              
            color<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">=</span> color<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//染上不同的颜色</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">DFS</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//继续递归</span>
                <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">else</span><span class="token comment">//如果搜到的是已经访问过的边：检查是否符合颜色 然后return</span>
        <span class="token punctuation">{</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">!=</span> v <span class="token operator">&amp;&amp;</span> color<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">==</span> color<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">//如果搜到除自己以外不同颜色点</span>
            <span class="token comment">//这里需要排除自环的影响 其实也不用啦 毕竟是DAG</span>
            <span class="token punctuation">{</span>
                <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool <span class="token function"><span class="token maybe-class-name">Is_BiPartGraph</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token maybe-class-name">UndirectedGraph</span> <span class="token constant">G</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//染色法判断二分图</span>
    <span class="token comment">//用DPS搜</span>
    vector<span class="token operator">&lt;</span>int<span class="token operator">></span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">.</span><span class="token property-access">n</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token constant">G</span><span class="token punctuation">.</span><span class="token property-access">n</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        color<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token constant">G</span><span class="token punctuation">.</span><span class="token property-access">n</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>color<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            color<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">DFS</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">,</span> color<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h3 id="cMuowuuMbNnpbeHCT1xS12" class="wolai-block"><span class="inline-wrap">主函数</span></h3><code-block id="7UCgtYKQZTsaXqv35ZohaS" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token maybe-class-name">UndirectedGraph</span> <span class="token constant">G</span><span class="token punctuation">;</span>
    int n<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> e<span class="token punctuation">;</span>
    <span class="token constant">G</span><span class="token punctuation">.</span><span class="token method function property-access">init</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token operator">:</span><span class="token operator">:</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function"><span class="token maybe-class-name">Is_BiPartGraph</span></span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h3 id="dwyNT6G99gMeyHYEbaRe6J" class="wolai-block"><span class="inline-wrap">测试数据</span></h3><code-block id="4g7e82Fat7MW9Dgjrqc7mT" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token number">6</span> <span class="token number">6</span>
<span class="token number">0</span> <span class="token number">3</span>
<span class="token number">0</span> <span class="token number">5</span>
<span class="token number">1</span> <span class="token number">3</span>
<span class="token number">1</span> <span class="token number">4</span>
<span class="token number">1</span> <span class="token number">5</span>
<span class="token number">2</span> <span class="token number">5</span> </pre></div></code-block><h3 id="jyf9q7ZEJ13ue5JyiddZ1G" class="wolai-block"><span class="inline-wrap">输出</span></h3><code-block id="kuqivLn2qEfbWLTXd3CcAc" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token number">1</span></pre></div></code-block><h1 id="e6ue1nMwhbtiY6Cacaox75" class="wolai-block"><span class="inline-wrap">匹配</span></h1><h3 id="7pSE1N8PECRD24yfwMVLoT" class="wolai-block"><span class="inline-wrap">匈牙利算法</span></h3><h4 id="5FGs6YqJGZdv2qVmtF5nMq" class="wolai-block"><span class="inline-wrap">【预备】增广路径</span></h4><h4 id="wkRHXmqNR92ykh715UGDdB" class="wolai-block"><span class="inline-wrap">【预备】反色</span></h4><h4 id="hb1bCKzQy1a9suHX3V4bHV" class="wolai-block"><span class="inline-wrap">【预备】贝尔热定理</span></h4><h4 id="hggCKaJpzfF34yoFJzBC8G" class="wolai-block"><span class="inline-wrap">算法</span></h4><ul class="wolai-block"><li id="35QBRSnoNx7TuxrSyoTGRH"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>初始化</mtext><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn><mtext>，</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">初始化visit[]=0，match[]=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">初始化</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></li><li id="srYgrMaJq69QiUYdxw7owC"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>u</mi><mo>∈</mo><mtext>第一部</mtext></mrow><annotation encoding="application/x-tex">for\ u∈第一部</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">第一部</span></span></span></span></span><ul class="wolai-block"><li id="8rY4bJud3Jmc7itBvrWNCR"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>初始化</mtext><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">初始化visit[]=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">初始化</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><aside id="jvLPoFuJPNCYsiFuGN5J16" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">为什么</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">visit[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">,每次都需要初始化一下？</span><div id="g6PgoMx2As2BVzcaLvcaQK" class="wolai-block wolai-text"><div><span class="inline-wrap">其实</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">visit[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">有点像：前面点</span><span class="inline-wrap"><b>看上</b></span><span class="inline-wrap">的匹配对象，后面的点不能再抢了</span></div></div></aside></li><li id="jr44di9ktAXS3S5EYvrRbF"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="bg-blond inline-wrap">bool maxmatch(int u)</span><ul class="wolai-block"><li id="6rP24vvHTYrGGsjLzuvAcy"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>v</mi><mo>∈</mo><mi>u</mi><mtext>的邻接点</mtext></mrow><annotation encoding="application/x-tex">for \ v∈u的邻接点</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">u</span><span class="mord cjk_fallback">的邻接点</span></span></span></span></span><ul class="wolai-block"><li id="3kVCt2Ema7XvAkb88KHJwY"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">if\ visit[v]==0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">//如果<span class="jill"></span>v<span class="jill"></span>没有被访问过</span><div id="frNRUD2aEPK1UEdJJ27HsA" class="wolai-block wolai-text"><div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>t</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">visit[v]=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></div></div><ul class="wolai-block"><li id="hvyLacgWquJLNeZNqiPHSu"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">if\ match[v]==0 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">//如果未匹配过</span><div id="oUuofafKVFs9h4VabWEaeD" class="wolai-block wolai-text"><div><span class="inline-wrap">    </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">match[v]=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span></div><aside id="2tDVpR3MgfeVtYtsdBvywP" class="wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">为什么改的不是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">match[u]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">呢？</span><div id="mAbjdW37rAWdn6znSzUY1S" class="wolai-block wolai-text"><div><span class="inline-wrap">两个都改会造成死循环</span></div></div><div id="kju4bQTDgrMndHxgKEcL25" class="wolai-block wolai-text"><div><span class="inline-wrap">我们其实只给右侧配对</span></div></div></aside></div><div id="dy5sHiXvQn5r9YqezJQVdD" class="wolai-block wolai-text"><div><span class="inline-wrap">    </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mtext> </mtext><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">return\  True</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></span></div></div></li><li id="8nVQVap71xgxQcbcs7aKFe"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">else</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">se</span></span></span></span></span><span class="inline-wrap">//如果已经匹配过</span><div id="7fdgvBT6bC7RXL5jYoPKtX" class="wolai-block wolai-text"><div><span class="inline-wrap">    </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>f</mi><mtext> 原来的</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mtext>这个点可以找到新的匹配点</mtext></mrow><annotation encoding="application/x-tex">if\ 原来的match[v]这个点可以找到新的匹配点</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"> </span><span class="mord cjk_fallback">原来的</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mord cjk_fallback">这个点可以找到新的匹配点</span></span></span></span></span></div><div id="iWUfbWLiVD5sDhK8WiRwEa" class="wolai-block wolai-text"><div><span class="inline-wrap">    </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo><mo>=</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">match[v]=u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span></span></div></div><div id="q76ohtixWmEYQstcjXa2K7" class="wolai-block wolai-text"><div><span class="inline-wrap">    </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mtext> </mtext><mi>T</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">return\ True</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></span></div></div></div></li></ul></li></ul></li><li id="4wn4K4SA23o1d6UrhiscnP"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mtext> </mtext><mi>F</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">return \ False</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">n</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">se</span></span></span></span></span></li></ul></li></ul></li></ul><h4 id="9h5odm2Hur1VrvSAXqBis1" class="wolai-block"><span class="inline-wrap">代码</span></h4><code-block id="r349WhTud52uR8DekBL1C9" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>struct <span class="token maybe-class-name">Edge</span>
<span class="token punctuation">{</span>
    int to<span class="token punctuation">;</span>
    <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    int w<span class="token punctuation">;</span><span class="token comment">//权值</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">BiPartGraph</span>
<span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> head<span class="token punctuation">[</span><span class="token constant">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    int n<span class="token punctuation">;</span>
    int m<span class="token punctuation">;</span>
    int e<span class="token punctuation">;</span>
    int visit<span class="token punctuation">[</span><span class="token constant">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    int match<span class="token punctuation">[</span><span class="token constant">N</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    bool <span class="token function">maxmatch</span><span class="token punctuation">(</span>int v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>int n<span class="token punctuation">,</span>int m<span class="token punctuation">,</span>int e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    int <span class="token function"><span class="token maybe-class-name">MaxMatch</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre></div></code-block><code-block id="nkkD3yko6VzgWxEbFvRJnz" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token maybe-class-name">BiPartGraph</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">MaxMatch</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    int ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>visit<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>visit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>match<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>match<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>visit<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>visit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token function">maxmatch</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            ans<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool <span class="token maybe-class-name">BiPartGraph</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">maxmatch</span><span class="token punctuation">(</span><span class="token parameter">int v</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>    
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span> now <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> now <span class="token operator">=</span> now<span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>visit<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            visit<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>match<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">maxmatch</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>match<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                match<span class="token punctuation">[</span>now<span class="token operator">-</span><span class="token operator">></span>to<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span>
                <span class="token keyword control-flow">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token maybe-class-name">BiPartGraph</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">int n<span class="token punctuation">,</span>int m<span class="token punctuation">,</span>int e</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//n代表左部点的个数，m代表右部点的个数,e代表边的条数</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>n <span class="token operator">=</span> n<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>m <span class="token operator">=</span> m<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>e <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        head<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>e<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//把n个点存在前面，m个点存在后面</span>
        int s<span class="token punctuation">,</span> t<span class="token punctuation">;</span>
        cin <span class="token operator">>></span> s <span class="token operator">>></span> t<span class="token punctuation">;</span>
        t <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>n <span class="token operator">+</span> t<span class="token punctuation">;</span>
        <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now1<span class="token punctuation">;</span>
        <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now2<span class="token punctuation">;</span>
        now1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        now2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token maybe-class-name">Edge</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        now1<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> t<span class="token punctuation">;</span>
        now2<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">=</span> s<span class="token punctuation">;</span>
        now1<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> now2<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token maybe-class-name">Edge</span><span class="token operator">*</span> now <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">==</span> t<span class="token punctuation">)</span>
                <span class="token keyword control-flow">break</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">else</span>
                now<span class="token operator">=</span>now<span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">!=</span> t <span class="token operator">&amp;&amp;</span> now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> now1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        now <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>head<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">while</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">==</span> s<span class="token punctuation">)</span>
                <span class="token keyword control-flow">break</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">else</span>
                now<span class="token operator">=</span>now<span class="token operator">-</span><span class="token operator">></span>next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>now<span class="token operator">-</span><span class="token operator">></span>to <span class="token operator">!=</span> s <span class="token operator">&amp;&amp;</span> now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            now<span class="token operator">-</span><span class="token operator">></span>next <span class="token operator">=</span> now2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h4 id="2Yv9nkrCP1PeTZTQ3tBs7J" class="wolai-block"><span class="inline-wrap">✅【模板题】最大匹配 洛谷<span class="jill"></span>P3386</span><div id="3FPTx8QWgURSXwTvS1EvWc" class="wolai-bookmark wolai-block"><a href="https://www.luogu.com.cn/problem/P3386">【模板】二分图最大匹配 - 洛谷</a><div class="info-box"><div class="text-pane"><div data-title="【模板】二分图最大匹配 - 洛谷"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://www.luogu.com.cn/favicon.ico&quot;)"></div><div data-hostname="www.luogu.com.cn"></div></div></div><div class="preview-pane"></div></div></div><div id="3Qh9Y6rpEbFTNHTuD83yy2" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image_2.png" style="width: 100%"/></figure></div><code-block id="nkfhBQ3k33TVWFFWm2n7Yg" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token maybe-class-name">BiPartGraph</span> <span class="token constant">G</span><span class="token punctuation">;</span>
    int n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> e<span class="token punctuation">;</span>
    <span class="token constant">G</span><span class="token punctuation">.</span><span class="token method function property-access">init</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token constant">G</span><span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">MaxMatch</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></h4><h1 id="m6KFn1KkqpWQEDFCXzmsSY" class="wolai-block"><span class="inline-wrap">二分图最优匹配：</span></h1><h2 id="5QgfNvo4PMpwL2Dmi9vn45" class="wolai-block"><span class="inline-wrap">【预备】最大权匹配：</span></h2><div id="fEGMWNaq5FihchMDqzvPTN" class="wolai-block wolai-text"><div><span class="inline-wrap">使所选边权和最大的匹配</span></div></div><div id="6g5PJiTtSPUhrQUzAzWxsX" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_3.png" style="width: 152px"/></figure></div><h2 id="t1Un1uPbSszJh8EbQcMi5L" class="wolai-block"><span class="inline-wrap">【预备】完全匹配（完备匹配） perfect matching：</span></h2><div id="6NpbyyBPurWuqPLtR72Brc" class="wolai-block wolai-text"><div><span class="inline-wrap">若<span class="jill"></span>X<span class="jill"></span>部和<span class="jill"></span>Y<span class="jill"></span>部中所有的顶点都是匹配<span class="jill"></span>M<span class="jill"></span>中的端点，则称<span class="jill"></span>M<span class="jill"></span>为完全匹配</span></div></div><h2 id="yH5VSt3hpCU9vPvscBTJg" class="bg-default wolai-block"><span class="inline-wrap">【预备】</span><span class="bg-blond inline-wrap"><b>完备匹配下</b></span><span class="bg-blond inline-wrap">的最大权匹配（最佳匹配）</span></h2><div id="8nT83HwKfcfjLB6MCPH7qq" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/image_4.png" style="width: 152px"/></figure></div><h2 id="fd3TjmjoYCqeT9J2BP8j44" class="wolai-block"><span class="inline-wrap">KM<span class="jill"></span>算法</span></h2><div id="a713GrdbASbyeqAtvR3in5" class="wolai-block wolai-text"><div><span class="inline-wrap">KM<span class="jill"></span>算法是一种计算机算法，功能是求</span><span class="inline-wrap"><b>完备匹配下</b></span><span class="inline-wrap">的最大权</span><span class="inline-wrap"><a href="https://baike.baidu.com/item/匹配/6397551"><span>匹配</span></a></span><span class="inline-wrap">。</span></div></div><div id="gY8yeymJuTM5L6BD6G8CKX" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>如果不存在完备匹配，那么算法会求最大匹配，如果最大匹配有多种，那么结果是最大匹配中权重和最大的。</b></span></div></div><div id="ewfXxanNXfSFCVDYoBYrXG" class="wolai-block wolai-text"><div><span class="inline-wrap">在一个二分图内，左顶点为<span class="jill"></span>X，右顶点为<span class="jill"></span>Y，现对于每组左右连接<span class="jill"></span>XiYj<span class="jill"></span>有权</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">,求最大匹配，并且使得该匹配中所有</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">的和是最大的。</span></div></div><div id="wV5qsou2JjGkvhg7bWsANH" class="wolai-block wolai-text"><div><span class="inline-wrap">该算法是通过给每个顶点一个标号（叫做顶标）来</span><span class="inline-wrap"><b>把求最大权匹配的问题转化为</b></span><span class="inline-wrap">求完备匹配的问题的。</span></div></div><h3 id="7M9WaU5CvUxVSUbVEZCDu2" class="wolai-block"><span class="inline-wrap">【预备】可行顶标</span></h3><div id="en5NbRUxsK5zRNMBGGAs3x" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>可行顶标</code></span><span class="inline-wrap">数组是人为添加的两个数组，一般为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>x</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>l</mi><mi>y</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">lx[n],ly[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span></span></span></span></span></div></div><h4 id="fFaUG89HaAg6a5nBhttb3E" class="wolai-block"><span class="inline-wrap">初始化</span></h4><div id="xbpaRo9nxCzL1sieKdJh3N" class="wolai-row"><div id="iEFmJHwBYbwkFxH1jjLQYp" class="wolai-col" style="flex-grow: 0.5"><div id="tDyKcVXhqCggTYamMvtGcV" class="wolai-block wolai-text"><div><span class="inline-wrap">一般来说，在初始状态下，选择顶点较少的部分作为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext>部</mtext></mrow><annotation encoding="application/x-tex">x部</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">部</span></span></span></span></span></div></div><ul class="wolai-block"><li id="5WmzudMbNcfqm7Q6zxGyyW"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>x</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">lx[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">的初值为出边中的最大权值</span></li><li id="toX4QWBwA17owChEAbJ5dk"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>y</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ly[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">的初值为<span class="jill"></span>0</span></li></ul></div><div id="og9ycZXvv8oMrvBuTaSYAF" class="wolai-col" style="flex-grow: 0.5"><div id="vYJyLsV8Hvdi1NwZ19YRas" class="wolai-block wolai-center"><figure class="wolai-left" style="width: 100%"><img src="media/image_5.png" alt="就是这张图中红色的文字" style="width: 238.3688439353098px"/><figcaption>就是这张图中红色的文字</figcaption></figure></div></div></div><aside id="gMa78g1837zFBEXrRjLMwk" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">关于这个数组具体的使用方法，我们在后面讨论</span></aside><h4 id="dJG8Q246Kr2TrUGdirbdJP" class="wolai-block"><span class="inline-wrap">性质</span></h4><ul class="wolai-block"><li id="mQWqopS3qDVNDyE2vQz33m"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">对于原图中的任意一条边</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">edge(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">满足</span><div id="9HJuqWVjmLMjaX7mYW7ZKu" class="wolai-block wolai-text"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>x</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>+</mo><mi>l</mi><mi>y</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mo>=</mo><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">lx[x]+ly[y]&gt;=weight(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></div></li><li id="39eNYn4R28awWy3e8u1RJS"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>相等子图</code></span><span class="inline-wrap">相等子图是原图的一个</span><span class="inline-wrap"><code>生成子图</code></span><span class="inline-wrap">,并且该</span><span class="inline-wrap"><code>生成子图</code></span><span class="inline-wrap">只包含满足</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>x</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>+</mo><mi>l</mi><mi>y</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>=</mo><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">lx[x]+ly[y]=weight(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">的边</span><div id="jwpYcF7dos7QHkkH9ExMCR" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>生成子图</code></span><span class="inline-wrap">：包含原图中的所有结点，但是不包含所有的边的子图</span></div></div></li><li id="81jngrWSEehLwYuzvvFk2k"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><code>最佳二分匹配</code></span><span class="inline-wrap"> 如果原图的一个</span><span class="inline-wrap"><code>相等子图</code></span><span class="inline-wrap">中包含</span><span class="inline-wrap"><code>完备匹配</code></span><span class="inline-wrap">，那么这个匹配就是原图的</span><span class="inline-wrap"><code>最佳二分匹配</code></span></li></ul><aside id="dk38iGry6c2PBMY6nLPDN" class="bg-cultured wolai-block"><div data-symbol="✒️" class="icon"></div><span class="inline-wrap">说实话，没看懂</span></aside><h3 id="to6bGJdkQ1FPMUzmUBGc5N" class="wolai-block"><span class="inline-wrap">KM<span class="jill"></span>算法</span></h3><ul class="wolai-block"><li id="p5WDTENB7dy3LM1N3Cc8B6"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">初始化</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>x</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">lx[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">和</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>y</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ly[]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mclose">]</span></span></span></span></span><span class="inline-wrap">数组</span></li></ul><code-block id="aRkv6YTrDUwucySffLUaxH" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>
int <span class="token function">bfs</span><span class="token punctuation">(</span><span class="token parameter">int u</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    tail<span class="token operator">=</span>head<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>que<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>u<span class="token punctuation">;</span>
    pre<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">while</span><span class="token punctuation">(</span>tail<span class="token operator">&lt;=</span>head<span class="token punctuation">)</span><span class="token punctuation">{</span>
        u<span class="token operator">=</span>que<span class="token punctuation">[</span>tail<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>vis<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int i<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>lw<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">+</span>lw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword control-flow">continue</span><span class="token punctuation">;</span>
            vis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> pre<span class="token punctuation">[</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>u<span class="token punctuation">,</span>que<span class="token punctuation">[</span><span class="token operator">++</span>head<span class="token punctuation">]</span><span class="token operator">=</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">else</span><span class="token punctuation">{</span>
                int d<span class="token operator">=</span>u<span class="token punctuation">,</span>e<span class="token operator">=</span>i<span class="token punctuation">,</span>t<span class="token punctuation">;</span>
                <span class="token keyword control-flow">while</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    t<span class="token operator">=</span>match<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    match<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token operator">=</span>e<span class="token punctuation">;</span>match<span class="token punctuation">[</span>e<span class="token punctuation">]</span><span class="token operator">=</span>d<span class="token punctuation">;</span>
                    d<span class="token operator">=</span>pre<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">;</span>e<span class="token operator">=</span>t<span class="token punctuation">;</span> 
                <span class="token punctuation">}</span>
                <span class="token keyword control-flow">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
long long <span class="token function">max_match</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>num_left<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> lw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">max</span><span class="token punctuation">(</span>lw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">G</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>num_left<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>sizeof vis<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">memset</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span>sizeof d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token function">bfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword control-flow">continue</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_left<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword control-flow">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int k<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> d<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">min</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>lw<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>lw<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">-</span><span class="token constant">G</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            int now<span class="token operator">=</span><span class="token number">1e9</span><span class="token punctuation">,</span>to<span class="token punctuation">,</span>s<span class="token punctuation">;</span>
            <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> now<span class="token operator">=</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">min</span><span class="token punctuation">(</span>now<span class="token punctuation">,</span>d<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_left<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token keyword control-flow">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> lw<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-=</span>now<span class="token punctuation">;</span>
            <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> lw<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+=</span>now<span class="token punctuation">;</span> 
                <span class="token keyword control-flow">else</span> d<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-=</span>now<span class="token punctuation">,</span>to<span class="token operator">=</span>d<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">?</span>to<span class="token operator">:</span>j<span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>match<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword control-flow">break</span><span class="token punctuation">;</span>
            s<span class="token operator">=</span>match<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>vis<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token operator">=</span>vis<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int j<span class="token operator">=</span>num_left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> d<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">min</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>lw<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token operator">+</span>lw<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span><span class="token constant">G</span><span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">memset</span><span class="token punctuation">(</span>vis<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>sizeof vis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">bfs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token constant">LL</span> ans<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>num_right<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> ans<span class="token operator">+=</span>lw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword control-flow">return</span> ans<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
int <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    num_left<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>num_right<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>m<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    int nnn<span class="token operator">=</span>num_left<span class="token punctuation">;</span>
    num_left<span class="token operator">=</span>num_right<span class="token operator">=</span>std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">max</span><span class="token punctuation">(</span>num_left<span class="token punctuation">,</span>num_right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    num_right<span class="token operator">+=</span>num_left<span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int u<span class="token punctuation">,</span>v<span class="token punctuation">,</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>m<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        u<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>num_left<span class="token punctuation">;</span><span class="token constant">G</span><span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span><span class="token constant">G</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span><span class="token function">max_match</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span><span class="token punctuation">(</span>reg int i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>nnn<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        std<span class="token operator">:</span><span class="token operator">:</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token constant">G</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>num_left<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h3 id="81syDDdVt2LSzjJDy7w7SD" class="wolai-block"><span class="inline-wrap">变形</span></h3><h4 id="9R28AtMiP6SFzgQx8ijGA2" class="wolai-block"><span class="inline-wrap">如果要求最小权完备匹配怎么办？</span></h4><div id="rNXiAsdkZH8x5zfYfVjava" class="wolai-block wolai-text"><div><span class="inline-wrap">只需将所有的边权值取其相反数。</span></div></div><h4 id="goMem5KqSAWksXPYGrQBnX" class="wolai-block"><span class="inline-wrap">边权积最大怎么转化？</span></h4><div id="rYUo1cBoWxFQZ6E6n4MTAY" class="wolai-block wolai-text"><div><span class="inline-wrap">每条边权取自然对数，然后求最大边权匹配，然后转化出结构<span class="jill"></span>a，在</span></div></div><h3 id="e2Hk3Jayt4B4dCjukzhRXe" class="wolai-block"><span class="inline-wrap">解题记录</span></h3><div id="enUyXa1nynoEs9pravnbaK" class="wolai-bookmark wolai-block"><a href="https://www.luogu.com.cn/problem/P1559">运动员最佳匹配问题 - 洛谷</a><div class="info-box"><div class="text-pane"><div data-title="运动员最佳匹配问题 - 洛谷"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://www.luogu.com.cn/favicon.ico&quot;)"></div><div data-hostname="www.luogu.com.cn"></div></div></div><div class="preview-pane"></div></div></div><div id="9pbxAnemw65DADBDPor56P" class="wolai-sub-page wolai-block"><div data-symbol="✨" class="page-icon"></div><a href="%E7%82%B9%E8%A6%86%E7%9B%96&amp;%E8%B7%AF%E5%BE%84%E8%A6%86%E7%9B%96/%E7%82%B9%E8%A6%86%E7%9B%96&amp;%E8%B7%AF%E5%BE%84%E8%A6%86%E7%9B%96.html"><span>点覆盖&路径覆盖</span></a></div><div id="5qq8tMT9EcJ8A7UmrckTJT" class="wolai-block wolai-text"><div><span class="inline-wrap">婚姻</span></div></div><div id="ss98BNCFgLYcZy1fBkSMxG" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div><div id="to3pYsxG4GL3jhdNYhmTe" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/93045d58-f35f-4890-88e9-1bce685291fb.jpeg" style="width: 560px"/></figure></div></article><footer></footer></body></html>