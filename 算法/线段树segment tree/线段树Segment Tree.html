<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../css/wolai.css"/><title>线段树Segment Tree - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="线段树Segment Tree" class="main-title"></div></div></header><article><h1 id="wrB4kUqvy7HVkTvcmVrAzA" class="wolai-block"><span class="inline-wrap">MyNotes</span><div id="4iakf2w4y1jKBQM78BJ8Qq" class="wolai-bookmark wolai-block"><a href="https://blog.csdn.net/weixin_45697774/article/details/104274713">线段树 从入门到进阶（超清晰，简单易懂）_繁凡さん的博客-CSDN博客_线段树</a><div class="info-box"><div class="text-pane"><div data-title="线段树 从入门到进阶（超清晰，简单易懂）_繁凡さん的博客-CSDN博客_线段树"></div><div data-desc="目录第一部 概念引入第二部 简单（无pushdown）的线段树1、单点修改，区间查询2、区间修改，单点查询第三部 进阶线段树第四部 乘法（根号）线段树1、乘法线段树2、根号线段树模板题与代码：单点修改，区间查询：洛谷树状数组模板1区间修改，单点查询：洛谷树状数组模板2区间加法，洛谷线段树模板1区间乘法：洛谷线段树模板2区间根号，bzoj3211线段树是什么？？线段树怎么写？？如果你在考提高组前.."></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://g.csdnimg.cn/static/logo/favicon32.ico&quot;)"></div><div data-hostname="blog.csdn.net"></div></div></div><div class="preview-pane"></div></div></div><h2 id="qgR8oBMaLYaCq6EiNdRDBD" class="wolai-block"><span class="inline-wrap">作用：把一些对于区间（或者线段）的修改、维护，从</span><span class="inline-wrap"><code>O(N)</code></span><span class="inline-wrap">的时间复杂度变成</span><span class="inline-wrap"><code>O（logN）</code></span><span class="inline-wrap">。</span></h2><h2 id="E8eYfNgUA75ABA8JmTq2Q" class="wolai-block"><span class="inline-wrap">基本结构：</span><div id="wJShRHoYwDYPnJrBAoob5h" class="wolai-block wolai-text"><div><span class="inline-wrap"><b>叶子结点是原始数组中的数字，非叶子结点代表子孙的和</b></span></div></div><div id="onByTNfQp42tJBQBnQjjkY" class="wolai-block"><figure class="wolai-left" style="width: 100%"><img src="media/image.png" style="width: 604px"/></figure></div></h2></h1><h2 id="w21xTCmTofApkADrgFPdEc" class="wolai-block"><span class="inline-wrap">类结构：</span><div id="4cztLRpGoqnxtD1an3nUUd" class="wolai-block wolai-text"><div><span class="inline-wrap"><b><code>数组</code></b></span><span class="inline-wrap"><b> 模拟</b></span><span class="inline-wrap"><b><code>二叉树</code></b></span><span class="inline-wrap"><b>，所需空间为</b></span><span class="inline-wrap"><b><code>T[N*4]</code></b></span><span class="inline-wrap">  </span></div></div><div id="tfAek8q8Bpeg7gyrwxQqHQ" class="wolai-block wolai-text"><div><span class="inline-wrap">虽然不知道为什么，但是一直都这么教？</span></div></div><code-block id="8uMjW2eUYCQcGZ8kLn9Ekq" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre><span class="token keyword">class</span> <span class="token class-name">SegTree_Min</span>
<span class="token punctuation">{</span>  
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//初始化 其中a从0开始存，内部的T从1开始存 T[1]代表着根节点</span>
    <span class="token keyword">void</span> <span class="token function"><span class="token maybe-class-name">Init</span></span><span class="token punctuation">(</span>int a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> int <span class="token maybe-class-name">Len</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token comment">//查询区间内最小值</span>
    int <span class="token function"><span class="token maybe-class-name">Query</span></span><span class="token punctuation">(</span>int ql<span class="token punctuation">,</span> int qr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//单节点更新</span>
    <span class="token keyword">void</span> <span class="token function"><span class="token maybe-class-name">Update_Node</span></span><span class="token punctuation">(</span>int x<span class="token punctuation">,</span> int value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    int<span class="token operator">*</span> <span class="token constant">T</span><span class="token punctuation">;</span><span class="token comment">//动态数组，用来储存新建的树，大小为N*4</span>
    int<span class="token operator">*</span> <span class="token maybe-class-name">In</span><span class="token punctuation">;</span><span class="token comment">//动态数组，用来储存原数组，大小为N+1</span>
    int <span class="token constant">N</span><span class="token punctuation">;</span>    
    <span class="token comment">//求两个子树的最小值</span>
    int <span class="token function"><span class="token maybe-class-name">PushUp</span></span><span class="token punctuation">(</span>int now<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//快速求左孩子</span>
    int <span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span>int x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//快读求右孩子</span>
    int <span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span>int x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//构建线段树，其中left和right对应着在原数组的构建位置</span>
    <span class="token keyword">void</span> <span class="token function"><span class="token maybe-class-name">Build</span></span><span class="token punctuation">(</span>int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    int <span class="token function"><span class="token maybe-class-name">QueryMin</span></span><span class="token punctuation">(</span>int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">,</span> int ql<span class="token punctuation">,</span> int qr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function"><span class="token maybe-class-name">Update_Node_Change</span></span><span class="token punctuation">(</span>int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">,</span> int x<span class="token punctuation">,</span> int value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre></div></code-block></h2><h2 id="oAqvnu4DrMTyebh4NdCQGz" class="wolai-block"><span class="inline-wrap">辅助函数</span></h2><code-block id="qQVXyU1VC8Z91Dndvqvsqd" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span><span class="token parameter">int x</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> x <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span><span class="token parameter">int x</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><h2 id="d4JBTksZjrCbQgdEJ3Ddcp" class="wolai-block"><span class="inline-wrap">建树：</span><code-block id="h62qVLtTAju7DxCoUhNtAX" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre><span class="token keyword">void</span> <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Init</span></span><span class="token punctuation">(</span><span class="token parameter">int a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> int <span class="token maybe-class-name">Len</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span> <span class="token operator">=</span> <span class="token maybe-class-name">Len</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token maybe-class-name">In</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span>int i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token maybe-class-name">In</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//把外部数组a输入到内部的in中</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Build</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//从根节点开始建树</span>
    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Build</span></span><span class="token punctuation">(</span>int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">)</span><span class="token comment">//now表示当前所在的树上节点</span>
<span class="token comment">//[left,right]表示子树所对应的原数组区间</span>
<span class="token punctuation">{</span>
    <span class="token comment">//如果是叶子结点的话，直接赋值</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> right<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span>now<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token maybe-class-name">In</span><span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    int mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//左右子树各自建树</span>
    <span class="token function"><span class="token maybe-class-name">Build</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function"><span class="token maybe-class-name">Build</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span>now<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">PushUp</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//建完树后需要回头更新</span>
    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></code-block></h2><h2 id="mEF443QsSxqGZYXSmWeqT6" class="wolai-block"><span class="inline-wrap">查询最小值</span><div id="qqsX6fneMNDsHSPgkbDoFF" class="wolai-block wolai-text"><div><span class="inline-wrap">我们总结一下，线段树的查询方法：</span></div></div><div id="7GSrRJ6s4N3gk5YYYcTR9g" class="wolai-block wolai-text"><div><span class="inline-wrap">目标：选出一些区间，使他们相连后恰好覆盖整个查询区间</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>q</mi><mi>l</mi><mo separator="true">,</mo><mi>q</mi><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[ql,qr]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">ql</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span></span></div></div><ol class="wolai-block"><li id="vT5o9ZzcBZEa6q9a18P6Sf"><div class="marker"></div><span class="inline-wrap">如果这个区间被完全包括在目标区间里面，直接返回这个区间的值</span></li><li id="ooK58DgTrAJrwk3b9PtZUC"><div class="marker"></div><span class="inline-wrap">如果这个区间的左儿子和目标区间有交集，那么搜索左儿子</span></li><li id="8P6MFmvSfRNE1X8t7qD4hs"><div class="marker"></div><span class="inline-wrap">如果这个区间的右儿子和目标区间有交集，那么搜索右儿子</span></li></ol><code-block id="oyh9ewHVjQkA3qRtRY4yAz" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre>int <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Query</span></span><span class="token punctuation">(</span>int ql<span class="token punctuation">,</span> int qr<span class="token punctuation">)</span><span class="token comment">//对应的原数组的查询区间</span>
<span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">QueryMin</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span><span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">QueryMin</span></span><span class="token punctuation">(</span><span class="token parameter">int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">,</span> int ql<span class="token punctuation">,</span> int qr</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//如果这个区间被完全包括在目标区间里面，直接返回这个区间的值</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>ql <span class="token operator">&lt;=</span> left <span class="token operator">&amp;&amp;</span> qr <span class="token operator">>=</span> right<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token constant">T</span><span class="token punctuation">[</span>now<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    int mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    int minn <span class="token operator">=</span> <span class="token constant">INT16_MAX</span><span class="token punctuation">;</span>
    
    <span class="token comment">//如果这个区间的左儿子和目标区间有交集，那么搜索左儿子</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>ql <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span>minn <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minn<span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">QueryMin</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//如果这个区间的右儿子和目标区间有交集，那么搜索右儿子</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>qr <span class="token operator">></span> mid<span class="token punctuation">)</span>minn <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minn<span class="token punctuation">,</span> <span class="token function"><span class="token maybe-class-name">QueryMin</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">,</span> ql<span class="token punctuation">,</span> qr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword control-flow">return</span> minn<span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></h2><div id="qM5ootjxGNJDsMFbkdDrhD" class="wolai-block"><figure class="wolai-center" style="width: 100%"><img src="media/bce65d4aab74da4c4a90c9768d6861d8.png" style="width: 100%"/></figure></div><h2 id="fHSGJQYmu67Ut6W6Zm8JEG" class="wolai-block"><span class="inline-wrap">单点修改</span><code-block id="tEbS8qjNCPEdTBehHEJtoN" class="wolai-block"><div class="wolai-pre"><div data-lang="C++" class="marker"></div><pre><span class="token keyword">void</span> <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Update_Node</span></span><span class="token punctuation">(</span><span class="token parameter">int i<span class="token punctuation">,</span> int value</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//下沉找到区间后，再pushup上来更新上面的结点</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Update_Node_Change</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">N</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">Update_Node_Change</span></span><span class="token punctuation">(</span><span class="token parameter">int now<span class="token punctuation">,</span> int left<span class="token punctuation">,</span> int right<span class="token punctuation">,</span> int x<span class="token punctuation">,</span> int value</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token comment">//x目标节点 now 当前树上节点 【left，right】当前对应区间 value修改的值 </span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> right<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span>now<span class="token punctuation">]</span> <span class="token operator">+=</span> value<span class="token punctuation">;</span><span class="token comment">//只修改叶子结点</span>
        <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    int mid<span class="token punctuation">;</span>
    mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> mid<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Update_Node_Change</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> left<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> x<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">else</span>
        <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Update_Node_Change</span></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">,</span> mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">,</span> x<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//修改之后，需要回头修改之前的值</span>
    <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span>now<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">PushUp</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
int <span class="token maybe-class-name">SegTree_Min</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function"><span class="token maybe-class-name">PushUp</span></span><span class="token punctuation">(</span><span class="token parameter">int now</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token comment">//这里可以通过修改pushup来调整线段树储存的信息究竟是什么</span>
    <span class="token keyword control-flow">return</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Lchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function"><span class="token maybe-class-name">Rchild</span></span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></code-block></h2><h2 id="aFzgqMrgQQoGsyeSC3JCZ4" class="wolai-block"><span class="inline-wrap">复杂度分析</span></h2><div id="ceJdkffWcvw9nisa4WxeFT" class="wolai-block wolai-text"><div><span class="inline-wrap">预处理</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div></div><div id="dH7TzErkFqpBNnW41pSvHm" class="wolai-block wolai-text"><div><span class="inline-wrap">查询/更新 </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div></div><div id="mbTFSPTD1mktpCoN2jknp7" class="wolai-block wolai-text"><div><span class="inline-wrap">额外的空间 </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
O(n) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div></div><h1 id="aHgDVzoXSGkbdSXJREAL36" class="wolai-block"><span class="inline-wrap">解题记录</span></h1><div class="block-ref"><div class="decorator"></div><div id="4pBa8wVP4CoQLRPSNDxwzb" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="https://www.wolai.com/4pBa8wVP4CoQLRPSNDxwzb"><span>P3372 【模板】线段树 1</span></a></div></div><div class="block-ref"><div class="decorator"></div><div id="x4phuneEZtZoE7MGxkgBo7" class="wolai-sub-page wolai-block"><div class="page-icon"></div><a href="https://www.wolai.com/x4phuneEZtZoE7MGxkgBo7"><span>买票</span></a></div></div><div id="fhLRnyPAnkLzRDKPVK9YY8" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>